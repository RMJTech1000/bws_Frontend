@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.min.js"></script>
<script>
    LayoutApp.controller('MyController', function ($scope, $http, Upload, $timeout) {
        $(document).ready(function () {
            $('.my-select').select2({ placeholder: "--Select--", allowClear: true, width: '100%' });
        });


        $scope.SelectedFiles = null;
        $scope.UploadFiles = function (files) {

            $scope.SelectedFiles = files;
            if ($scope.SelectedFiles && $scope.SelectedFiles.length) {
                if ($scope.SelectedFiles && $scope.SelectedFiles.length) {
                    Upload.upload({
                        url: '/Sales/UploadWaiver/',
                        data: {
                            files: $scope.SelectedFiles

                        }
                    }).then(function (response) {
                        $timeout(function () {

                            $scope.txtFileName = response.data;
                            $('#upload-file-info').text("");

                        });
                    }, function (response) {
                        if (response.status > 0) {
                            var errorMsg = response.status + ': ' + response.data;

                        }
                    }, function (evt) {
                        var element = angular.element(document.querySelector('#dvProgress'));
                        $scope.Progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));
                        element.html('<div style="width: ' + $scope.Progress + '%">' + $scope.Progress + '%</div>');
                    });
                }

            }

        }

        $scope.ChargeCodeDetails = null;
        $scope.fillChargeCodeDetails = function () {
            $http({
                method: 'POST',
                url: '/api/WaiverRequest/WaiverChargeList/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.ChargeCodeDetails = result.data;
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillChargeCodeDetails();

        $scope.RequestTypeAllvalues = null;
        $scope.fillRequestTypeAllvalues = function () {
          
            var Datavalue = {};
            Datavalue.ID = "37"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.RequestTypeAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillRequestTypeAllvalues();

        $scope.ChargeTypeAllvalues = null;
        $scope.fillChargeTypeAllvalues = function () {

            var Datavalue = {};
            Datavalue.ID = "45"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ChargeTypeAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillChargeTypeAllvalues();

        $scope.TransactionTypesValues = [
         
            { 'name': 'Agency Export', 'ID': 1 },
            { 'name': 'Agency Import', 'ID': 2 }
        ];

        $scope.BooingNoAllValues = null;
        $scope.fillBooingNoAllValues = function () {

           
            var Datavalue = {};
            Datavalue.ID = "0"; 
            $http({
                method: 'POST',
                url: '/api/WaiverRequest/WaierBookingNo/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.BooingNoAllValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBooingNoAllValues();


        $scope.CntrTypesvalues = null;
        $scope.fillCntrTypeValues = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CntrTypeValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrTypesvalues = result.data;


                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCntrTypeValues();

        $scope.BookingCntrAllValues = null;


        $("#ddlBLNo").change(function () {

            var Datavalue = {};
            Datavalue.BkgID = $("#ddlBLNo").val();
            $http({
                method: 'POST',
                url: '/api/WaiverRequest/WaierBookingCntrNo/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.BookingCntrAllValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        });

        $scope.ChangeBlNo = function(BkgIDv)
        {
            var Datavalue = {};
            Datavalue.BkgID = BkgIDv;
            $http({
                method: 'POST',
                url: '/api/WaiverRequest/WaierBookingCntrNo/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.BookingCntrAllValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }

        $scope.UserNameMasterAllvalues = null;
        $scope.fillUserMasterValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/UserMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.UserNameMasterAllvalues = result.data;
                    $scope.ddlRequested = { ID: localStorage.getItem("UserID")};


                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillUserMasterValues();

        $scope.DynamicGrid = [{
            RequestTypeID: "", RequestType: "",  TransTypeID: "", TransType: "", BookingID: "",
            BookingNo: "", CntrTypeID: "", CntrTypes: "", ContainerNo: "", ContainerID: "", Freedays: "", WaiverAmt: "", Waiver: "", ChargeTypeID: "", ChargeType: ""
        }];
        $scope.DynamicGrid.splice(0, 1);

        $scope.Add = function ()
        {
           
            var validation = "";
            var ddlRequestType = $('#ddlRequestType').val();
            if (ddlRequestType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Request Type</span></br>"
            }

            var ddlChargeType = $('#ddlChargeType').val();
            if (ddlChargeType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Charge Type</span></br>"
            }

            var ddlTransactionType = $('#ddlTransactionType').val();
            if (ddlTransactionType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Transaction Type</span></br>"
            }
            var ddlBLNo = $('#ddlBLNo').val();
            if (ddlBLNo == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Booking No</span></br>"
            }

            var CntrType = "";
            var CntrTypeID = 0;
            var ContainerNo = "";
            var ContainerID = 0;
            var Freedays = 0;
            
           
            if ($("#ddlRequestType").val() == "121")
            {
                CntrType = "";
                CntrTypeID = 0;
                Freedays = 0;
                var txtWaiverAmt = $('#txtWaiverAmt').val();
                if (txtWaiverAmt.length == "") {
                    txtWaiverAmt = 0;
                    validation += "<span style='color:red;'>*</span> <span>Please Enter Waiver Amount</span></br>"
                }
                var txtWaiverPer = $('#txtWaiverPer').val();
                if (txtWaiverPer.length == "") {
                    txtWaiverPer = 0;
                    validation += "<span style='color:red;'>*</span> <span>Please Enter Waiver Percentage</span></br>"
                }
            }
            else if ($("#ddlRequestType").val() == "122")
            {
                Freedays = 0;
                var txtWaiverAmt = $('#txtWaiverAmt').val();
                if (txtWaiverAmt.length == "") {
                    txtWaiverAmt = 0;
                    validation += "<span style='color:red;'>*</span> <span>Please Enter Waiver Amount</span></br>"
                }
                var txtWaiverPer = $('#txtWaiverPer').val();
                if (txtWaiverPer.length == "") {
                    txtWaiverPer = 0;
                    validation += "<span style='color:red;'>*</span> <span>Please Enter Waiver Percentage</span></br>"
                }
               

            }
            else if ($("#ddlRequestType").val() == "123")
            {
                txtWaiverAmt = 0;
                txtWaiverPer = 0;
                var CntrType = "";
                var CntrTypeID = 0;
                var ContainerNo = "";
                var ContainerID = 0;
                var txtFreedays = $('#txtFreedays').val();
                if (txtFreedays.length == "") {
                    txtFreedays = 0;
                    validation += "<span style='color:red;'>*</span> <span>Please Enter FreeDays</span></br>"
                }

            }



            if (validation != "") {
                ShowPopup(validation);
                return false;
            }

            var val = {
                'RequestTypeID': $("#ddlRequestType").val(),
                'RequestType': $("#ddlRequestType option:selected").text(),
                
                'TransTypeID': $("#ddlTransactionType").val(),
                'TransType': $("#ddlTransactionType option:selected").text(),
                'BookingID': $("#ddlBLNo").val(),
                'BookingNo': $("#ddlBLNo option:selected").text(),
                'CntrTypeID': CntrTypeID,
                'CntrTypes': CntrType,
                'ContainerID': ContainerID,
                'ContainerNo': ContainerNo,
                'Freedays': $scope.txtFreedays,
                'WaiverAmt': $scope.txtWaiverAmt,
                'Waiver': $scope.txtWaiverPer,
                'ChargeTypeID': $("#ddlChargeType").val(),
                'ChargeType': $("#ddlChargeType option:selected").text()

            };

            if ($scope.HDArrayIndex != null && $scope.HDArrayIndex.length != 0) {
                $scope.DynamicGrid[$scope.HDArrayIndex] = val;
            } else {
                $scope.DynamicGrid.push(val);
            }
          
            $("#ddlRequestType").val("");
            $("#ddlChargeType").val("");
            $("#ddlTransactionType").val("");
            $("#ddlBLNo").val("");
            $("#ddlContainerType").val("");
            $("#ddlContainerNo").val("");
            $scope.txtFreedays = "";
            $scope.txtWaiverAmt = "";
            $scope.txtWaiverPer = "";
            $scope.HDArrayIndex = "";
           
        }

        $scope.Selectvalues = function (DynamicGrid, index)
        {
            $scope.ChangeBlNo($scope.DynamicGrid[index].BookingID);
            $scope.HDArrayIndex = index;
            $scope.ddlRequestType = { ID: $scope.DynamicGrid[index].RequestTypeID };           
            $scope.ddlTransactionType = { ID: $scope.DynamicGrid[index].TransTypeID };
            $scope.ddlBLNo = { ID: $scope.DynamicGrid[index].BookingID };          
            $scope.ddlContainerType = { ID: $scope.DynamicGrid[index].CntrTypeID };
            $scope.ddlContainerNo = { ID: $scope.DynamicGrid[index].ContainerID };
            $scope.txtFreedays = $scope.DynamicGrid[index].Freedays;
            $scope.txtWaiverAmt = $scope.DynamicGrid[index].WaiverAmt;
            $scope.txtWaiverPer = $scope.DynamicGrid[index].Waiver;
            $scope.ddlChargeType = { ID: $scope.DynamicGrid[index].ChargeTypeID };
        }

        $scope.RecordSave = function (gData) {

            var validation = "";
           
            var BussData = {}
            var Items = []
            var Datav = "undefined";


            var ddlRequested = $('#ddlRequested').val();
            if (ddlRequested == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please add Waiver Request Details </span></br>"
            }
            if (gData.length == 0) {

                var validation = "";
                validation += "<span style='color:red;'>*</span> <span>Please add Waiver Request Details </span></br>"
                
            }
            if (validation != "") {
                ShowPopup(validation);
                return;
            }
            angular.forEach(gData, function (value, key) {
                var CntrTypeIDv = 0;
                var ContainerIDv = 0;
                var Freedaysv = 0;
                var WaiverAmtv = 0;
                var Waiverv = 0;
                if (typeof gData[key].CntrTypeID != "undefined") {
                    CntrTypeIDv = gData[key].CntrTypeID;
                }
                if (typeof gData[key].ContainerID != "undefined") {
                    ContainerIDv = gData[key].ContainerID;
                }
                if (typeof gData[key].Freedays != "undefined")
                {
                    Freedaysv = gData[key].Freedays;
                }
                if (typeof gData[key].WaiverAmt != "undefined") {
                    WaiverAmtv = gData[key].WaiverAmt;
                }
                if (typeof gData[key].Waiver != "undefined") {
                    Waiverv = gData[key].Waiver;
                }
                Items.push('Insert:' + gData[key].RequestTypeID,
                    
                    gData[key].TransTypeID,
                    gData[key].BookingID,
                    CntrTypeIDv,
                    ContainerIDv,
                    Freedaysv,
                    WaiverAmtv,
                    Waiverv,
                    gData[key].ChargeTypeID);
              

            });
           
            BussData.Itemsv = Items.toString();
            BussData.Remarks = $scope.txtRemarks;
            BussData.RequestBy = $('#ddlRequested').val();
            BussData.WaiverAttach = $scope.txtFileName;

            $http({
                method: 'POST',
                url: '/api/WaiverRequest/InsertWaier',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                ShowPopup(result.data[0].Message);
                $timeout(function ()
                {
                    var url = "/Sales/WaiverRequestView";
                    window.location.href = url;
                },3000);
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });
        }


        $(document).ready(function () {

            var queryString = new Array();
            if (window.location.search.split('?').length > 1) {
                var secret_key = CryptoJS.enc.Utf8.parse(localStorage.getItem("SessionKey"));
                var iv = CryptoJS.enc.Utf8.parse(localStorage.getItem("Sessioniv"));
                var bytes = CryptoJS.AES.decrypt(window.location.search.split('?')[1].toString(), secret_key, {
                    iv: iv,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                });

                var params = bytes.toString(CryptoJS.enc.Utf8).split('&');
                //alert(params);
                for (var i = 0; i < params.length; i++) {
                    var key = params[i].split('=')[0];
                    var value = decodeURIComponent(params[i].split('=')[1]);
                    queryString[key] = value;

                }
            }
            

            if (queryString["WaiverID"] != null)
            {
                $scope.fillWaiverRequestview(queryString["WaiverID"].toString());
            }
        });

        $scope.fillWaiverRequestview = function (WaivID) {
            var BussData = {};
            BussData.ID = WaivID;

            $http({
                method: 'POST',
                url: '/api/WaiverRequest/WaierViewValues/',
                data: JSON.stringify(BussData),
            }).then(function (result) {
                $timeout(function () {
                    console.log(result.data);
                    $scope.DynamicGrid = result.data;
                    $scope.txtRemarks = result.data[0].Remarks;
                    $scope.ddlRequested = { ID: result.data[0].RequestBy };
                    $scope.txtFileName = result.data[0].WaiverAttach;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };

        $("#ddlRequestType").change(function () {

            if ($("#ddlRequestType").val() == "121") {
                document.getElementById("ddlContainerType").style.display = "none";
                document.getElementById("ddlContainerType").disabled = true;
                $("#ddlContainerType").val(null).trigger("change");
                document.getElementById("txtWaiverAmt").disabled = false;
                document.getElementById("txtWaiverPer").disabled = false;

                document.getElementById("ddlContainerNo").style.display = "none";
                document.getElementById("ddlContainerNo").disabled = true;
                $("#ddlContainerNo").val(null).trigger("change");

                document.getElementById("txtFreedays").disabled = true;
            }
            else if ($("#ddlRequestType").val() == "122") {
                document.getElementById("ddlContainerType").disabled = false;
                document.getElementById("ddlContainerNo").disabled = false;
                document.getElementById("txtFreedays").disabled = true;
            }
            else if ($("#ddlRequestType").val() == "123") {
                document.getElementById("ddlContainerType").disabled = true;
                document.getElementById("ddlContainerNo").disabled = true;
                document.getElementById("txtWaiverAmt").disabled = true;
                document.getElementById("txtWaiverPer").disabled = true;
                document.getElementById("txtFreedays").disabled = false;
            }
        });


        $scope.RecordApproval = function (StatusID, gData) {

            var BussData = {}
            var validation = "";
            angular.forEach(gData, function (value, key) {
                BussData.BkgID = gData[key].BookingID
            });
            
            BussData.Status = StatusID;
            $http({
                method: 'POST',
                url: '/api/WaiverRequest/UpdateStatusWaier',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                ShowPopup(result.data[0].Message);
                $timeout(function () {
                    var url = "/Sales/WaiverRequestView";
                    window.location.href = url;
                }, 3000);
               
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });
        }

    });


    function ShowPopup(message) {
        swal(message);
    };

</script>
<style>
    .table > tbody > tr > td
    {
        font-size:12px!important;
    }
    .form-control.fileupload {
        border: 0;
        color: #e91e63;
    }
    .footbtn .btn {
        padding: 8px 12px;
    }
    .addbtn .btn {
        padding: 7px 18px;
    }
</style>
<div ng-app="MyApp" ng-controller="MyController">
    <div class="container-fluid">
      
        <div class="col-md-12 backbtn" style="text-align:right;">
           
            <a href="/Sales/WaiverRequestView" class="btn btn-fill btn-success btn-round btntop">
                <i class="material-icons">reply</i> Back

            </a>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="card-header card-header-primary card-header-text">
                        <div class="card-text">
                            <h4 class="card-title">Waiver Request - Rate Request</h4>
                        </div>
                    </div>
                    <div class="card-body ">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-12" style="border: 1px solid #ccc;">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Request Type</label>
                                                            <select class="form-control my-select"  id="ddlRequestType" ng-model="ddlRequestType" options="{ allowClear: true }" ng-options="item.GeneralName for item in RequestTypeAllvalues track by item.ID"></select>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Charge</label>
                                                            <select class="form-control my-select" id="ddlChargeType" ng-model="ddlChargeType" options="{ allowClear: true }" ng-options="item.ChgDesc for item in ChargeCodeDetails track by item.ID"></select>
                                                            @*<select class="form-control" id="ddlChargeType" ng-model="ddlChargeType" options="{ allowClear: true }" ng-options="item.GeneralName for item in ChargeTypeAllvalues track by item.ID"></select>*@
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Transaction Type</label>
                                                            <select class="form-control my-select" id="ddlTransactionType" ng-model="ddlTransactionType" options="{ allowClear: true }" ng-options="item.name for item in TransactionTypesValues track by item.ID"></select>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Booking/BL Number</label>
                                                            <select class="form-control my-select" id="ddlBLNo" ng-model="ddlBLNo" options="{ allowClear: true }" ng-options="item.BLNumber for item in BooingNoAllValues track by item.ID"></select>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>


                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Container Type</label>
                                                            <select class="form-control my-select" id="ddlContainerType" ng-model="ddlContainerType" ng-options="item.CntrTypes for item in CntrTypesvalues track by item.ID"></select>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Container Number</label>
                                                            <select class="form-control my-select" id="ddlContainerNo" ng-model="ddlContainerNo" ng-options="item.CntrNo for item in BookingCntrAllValues track by item.ID"></select>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Freedays</label>
                                                            <input type="text" id="txtFreedays" ng-model="txtFreedays" class="form-control" />
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Waiver Amt</label>
                                                            <input type="text" id="txtWaiverAmt" ng-model="txtWaiverAmt" class="form-control" />
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label>Waiver in %</label>
                                                            <input type="text" id="txtWaiverPer" ng-model="txtWaiverPer" class="form-control" />
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-11">
                                                            <label>Remarks</label>
                                                            <textarea id="txtRemarks" rows="5" ng-model="txtRemarks" class="form-control"></textarea>
                                                        </div>
                                                        <div class="col-md-1 padl0">
                                                            <div class="col-md-12 padlr0 addbtn" style="text-align:right; margin-top:58px;">
                                                                @*<a href="#" class="btn btn-danger">Check Container Rental</a>*@
                                                                <button type="button" rel="tooltip" ng-click="Add()" class="btn btn-success" data-original-title="" title="">
                                                                    <i class="material-icons">add</i>Add
                                                                </button>
                                                                <input type="hidden" id="HDArrayIndex" class="form-control" ng-model="HDArrayIndex" />
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>


                                </div>

                            </div>
                            <div class="col-md-12" style="border: 1px solid #ccc;padding-top:3px;padding-left:18px;">
                                <div class="row">
                                    <div class="col-md-10">

                                        <div class="row">
                                            <div class="col-md-12 padlr0">
                                                <div class="material-datatables" style="overflow-y:scroll;">

                                                    <table class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th>Select</th>
                                                                <th>Request Type</th>
                                                                <th>Trans Type</th>
                                                                <th>Booking/BL</th>
                                                                <th>Container Type</th>
                                                                <th>Container No</th>
                                                                <th>Freedays</th>
                                                                <th>Waiver Amt</th>
                                                                <th>Waiver %</th>
                                                                <th>Charge Type</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="gRow in DynamicGrid">
                                                                <td class="td-actions text-right bindgrid">

                                                                    <button type="button" rel="tooltip" ng-click="Selectvalues(DynamicGrid,$index)" class="btn btn-success btn-round" data-original-title="" title="">
                                                                        <i class="material-icons">edit</i>
                                                                    </button>

                                                                </td>
                                                                <td>
                                                                    {{gRow.RequestType}}
                                                                    <input type="hidden" id="RequestType" class="form-control" ng-model="gRow.RequestTypeID" />

                                                                </td>

                                                                <td>
                                                                    {{gRow.TransType}}
                                                                    <input type="hidden" id="TransType" class="form-control" ng-model="gRow.TransTypeID" />

                                                                </td>
                                                                <td>
                                                                    {{gRow.BookingNo}}
                                                                    <input type="hidden" id="BookingID" class="form-control" ng-model="gRow.BookingID" />

                                                                </td>
                                                                <td>
                                                                    {{gRow.CntrTypes}}
                                                                    <input type="hidden" id="CntrTypeID" class="form-control" ng-model="gRow.CntrTypeID" />

                                                                </td>
                                                                <td>
                                                                    {{gRow.ContainerNo}}
                                                                    <input type="hidden" id="ContainerID" class="form-control" ng-model="gRow.ContainerID" />

                                                                </td>
                                                                <td>
                                                                    {{gRow.Freedays}}
                                                                </td>
                                                                <td>
                                                                    {{gRow.WaiverAmt}}
                                                                </td>
                                                                <td>
                                                                    {{gRow.Waiver}}
                                                                </td>
                                                                <td>
                                                                    {{gRow.ChargeType}}
                                                                    <input type="hidden" id="ChargeTypeID" class="form-control" ng-model="gRow.ChargeTypeID" />

                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-2" style="border-left:1px solid #ccc;">
                                        <div class="col-md-12 addbtn padlr0">
                                            <div class="input-group" style="margin-top:15px;">
                                                <span class="input-group-addon"><a href="#" class="btn btn-rose btn-fill btn-round">Add Attachment</a></span>
                                                <input class="btn btn-primary" type="file" style='position:absolute;z-index:2;top:0;left:0;filter: alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"; opacity:0;background-color:transparent;color:transparent;' name="file_source" size="40" ngf-select="UploadFiles($files)" onchange='$("#upload-file-info").html($(this).val());'>

                                                <span class='label label-info' id="upload-file-info"></span>
                                            </div>

                                            <input type="text" ng-model="txtFileName" id="txtFileName" class="form-control fileupload" />
                                        </div>
                                    </div>
                                </div>
                                </div>
                            <div class="col-md-12" style="border:1px solid #ccc;">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-md-12 padr0">
                                                            <label>Requested By</label>
                                                            <select class="form-control my-select" disabled id="ddlRequested" ng-model="ddlRequested" ng-options="item.UserName for item in UserNameMasterAllvalues track by item.ID">
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>


                                        </div>
                                    </div>
                                    <div class="col-md-6 padr0">
                                        <div class="col-md-12 footbtn" style="text-align:right; margin-top:27px;">
                                            <button class="btn btn-danger" ng-click="RecordApproval(2,DynamicGrid);">Reject</button>
                                            <button class="btn btn-success" ng-click="RecordApproval(1,DynamicGrid);">Approval</button>
                                            <button class="btn btn-primary" ng-click="RecordSave(DynamicGrid);">Save</button>

                                            <input type="hidden" id="RegId" ng-model="RegId" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                        </div>
                </div>

            </div>
        </div>

    </div>
</div>
<script>
    $(document).ready(function () {
        $('.datepicker').datetimepicker({
            format: 'DD/MM/YYYY',

        });
    });
</script>