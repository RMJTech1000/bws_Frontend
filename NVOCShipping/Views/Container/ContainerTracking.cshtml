@model  NVOCShipping.Models.MasterModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>


<script type="text/javascript">

    LayoutApp.controller('MyController', function ($scope, $http, $timeout) {



        //$scope.AddNew = function () {
        //    window.location = "/Finance/TaxEngine"
        //}
        $scope.CntrNoList = null;
        $scope.FillCntrNo = function () {
            $http({
                method: 'POST',
                url: '/api/ContainerApi/BindCntrNos/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrNoList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.FillCntrNo();

        $scope.CntrSizeTypes = null;
        $scope.fillCntrSizeTypes = function () {
            $http({
                method: 'POST',
                url: '/api/ContainerApi/CntrTypeSize/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrSizeTypes = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillCntrSizeTypes();

        $scope.GeoLocationList = null;
        $scope.fillGeoLocationList = function () {
            $http({
                method: 'POST',
                url: '/api/Home/GeoLocationsMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.GeoLocationList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillGeoLocationList();

        $scope.PortList = null;
        $scope.fillPortList = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.PortList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillPortList();

        $scope.DepotValue = null;
        $scope.fillDepotValues = function () {
            $http({
                method: 'POST',
                url: '/api/ContainerApi/DepotValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.DepotValue = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillDepotValues();

        $scope.VesVoyList = null;
        $scope.fillVesVoyList = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/VesVoyMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.VesVoyList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillVesVoyList();


        $scope.PartyValues = null;
        $scope.FillPartyValues = function () {
            $http({

                method: 'POST',
                url: '/api/ContainerApi/PartyList/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.PartyValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        };
        $scope.FillPartyValues();

        $scope.BLAllValues = null;
        $scope.fillBLNumber = function () {
            $http({
                method: 'POST',
                url: '/api/ContainerApi/BookingBLList/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.BLAllValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBLNumber();

        $scope.TransitModeList = null;
        $scope.fillTransitModeList = function () {
            $http({
                method: 'POST',
                url: '/api/ContainerApi/TransitModeValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.TransitModeList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillTransitModeList();

        $scope.AgencyList = null;
        $scope.fillAgencyList = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/AgencyMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.AgencyList = result.data;

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected. Please reconnect and try again.");
                }
            });

        };
        $scope.fillAgencyList();

        $("#ddlCntrNo").change(function () {
            $scope.CntrStatusCodes = null;
            var Datavalue = {};

            Datavalue.ID = $("#ddlCntrNo").val();
            $http({
                method: 'POST',
                url: '/api/ContainerApi/CntrStatusandTypeByCntrNo/',
                data: JSON.stringify(Datavalue),
                // data: {}
            }).then(function (result) {
                $timeout(function () {

                    $("#ddlSizeType").val(result.data[0].CntrTypeID).trigger("change");

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        });


        $scope.CntrTrackingViewRecords = function () {
            //var validation = "";


            //var ddlCntrNo = $('#ddlCntrNo').val();
            //if (ddlCntrNo == "?") {

            //    validation += "<span style='color:red;'>*</span> <span>Please Select Container No </span></br>"
            //}


            //if (validation != "") {

            //    ShowPopup(validation);
            //    return false;
            //}
            var BussData = {}
            BussData.CntrID = $("#ddlCntrNo").val();
            BussData.CntrTypeID = $("#ddlSizeType").val();

            $http({
                method: 'POST',
                url: "/api/ContainerApi/ContainersTrackingView",
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $scope.CntrTxnsRec = result.data;

                if ($("#ddlCntrNo").val() != "" && $("#ddlCntrNo").val() != null && $("#ddlCntrNo").val() != "?") {

                    $scope.ShowOnlyForCntrSearch = true;
                }
            });

        }


        $scope.ClearRecords = function () {

            $("#ddlCntrNo").val(null).trigger("change");
            $("#ddlSizeType").val(null).trigger("change");

            var url = "/Container/ContainerTracking";
            window.location.href = url;
        }

        $scope.AmendmentEdit = function (TxnsID, CntrID, AgencyID) {

            if (localStorage.getItem("UserID") == "1" || localStorage.getItem("UserID") == "23" || localStorage.getItem("UserID") == "24" || localStorage.getItem("UserID") == "27") {

                $scope.BindAmendmentEdit(TxnsID, CntrID, AgencyID);
                $scope.IsVisible = true;
            }
            else {
                ShowPopup("Access Denied,Please Contact Administration");
                $scope.IsVisible = false;
            }
        }

        $scope.BindAmendmentEdit = function (TxnsID, CntrID, AgencyID) {


            var Data = {};
            Data.AgencyID = localStorage.getItem("AgencyID");
            Data.UserID = localStorage.getItem("UserID");
            $http({
                method: 'POST',
                url: '/api/ContainerApi/ValidateAgencyLastMove/',
                data: JSON.stringify(Data),

            })
                .then(function (response) {
                    $timeout(function () {
                        $scope.Result = response.data;

                        if (localStorage.getItem("AgencyID") != AgencyID) {
                            $scope.IsVisible = false;
                            ShowPopup("Cannot Amend Movement, Agency are different");
                            return false;
                        }
                        else {

                            $scope.HDTxnsId = TxnsID;
                            $scope.HDCntrId = CntrID;

                            var Datavalue = {}
                            var id = TxnsID;

                            if (id == "" || id == null)
                                Datavalue.ID = 0;
                            else
                                Datavalue.ID = TxnsID;

                            $http({
                                method: 'POST',
                                url: '/api/ContainerApi/AmendmentEdit/',
                                data: JSON.stringify(Datavalue),
                            }).then(function (result) {
                                $timeout(function () {

                                    if (result.data.length > 0) {

                                        $scope.StatusCode = result.data[0].StatusCode
                                        $('#txtAmdDtMovement').val(result.data[0].DtMovement);
                                        $('#ddlAmdVesVoy').val(result.data[0].VesVoyID).trigger("change");
                                        $('#ddlAmdToLoc').val(result.data[0].NextPortID).trigger("change");
                                        $('#ddlAmdModeofTrans').val(result.data[0].ModeOfTransportID).trigger("change");
                                        $('#ddlAmdDepot').val(result.data[0].DepotID).trigger("change");
                                        $('#ddlAmdParty').val(result.data[0].CustomerID).trigger("change");
                                        $('#ddlAgency').val(result.data[0].AgencyID).trigger("change");
                                        $('#ddlAmdBLNumber').val(result.data[0].BLID).trigger("change");

                                        //$scope.ddlAmdVesVoy = { ID: result.data[0].VesVoyID };
                                        // $scope.ddlAmdToLoc = { ID: result.data[0].NextPortID };
                                        // $scope.ddlAmdModeofTrans = { ID: result.data[0].ModeOfTransportID };
                                        // $scope.ddlAmdDepot = { ID: result.data[0].DepotID };
                                        // $scope.ddlAmdBLNumber = { ID: result.data[0].BLID };
                                        //$scope.ddlAmdParty = { ID: result.data[0].CustomerID };
                                        // $scope.ddlAgency = { ID: result.data[0].AgencyID };

                                    }
                                    else {
                                        $scope.txtAmdDtMovement = "";
                                        $scope.ddlAmdVesVoy = "";
                                        // $scope.ddlAmdFromLoc = "";
                                        $scope.ddlAmdToLoc = "";
                                        $scope.ddlAmdModeofTrans = "";
                                        $scope.ddlAmdDepot = "";
                                        $scope.ddlAmdBLNumber = "";
                                        $scope.ddlAmdParty = "";

                                    }
                                });
                            });

                        }


                    });
                }, function (response) {
                    if (response.status > 0) {

                        var errorMsg = response.status + ': ' + response.data;
                        ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                    }
                });

        }

        //$scope.BindAmendmentEdit = function (TxnsID, CntrID) {
        //    $scope.HDTxnsId = TxnsID;
        //    $scope.HDCntrId = CntrID;

        //    var Datavalue = {}
        //    var id = TxnsID;

        //    if (id == "" || id == null)
        //        Datavalue.ID = 0;
        //    else
        //        Datavalue.ID = TxnsID;

        //    $http({
        //        method: 'POST',
        //        url: '/api/ContainerApi/AmendmentEdit/',
        //        data: JSON.stringify(Datavalue),
        //    }).then(function (result) {
        //        $timeout(function () {

        //            if (result.data.length > 0) {

        //                $scope.StatusCode = result.data[0].StatusCode
        //                $('#txtAmdDtMovement').val(result.data[0].DtMovement);
        //                $('#ddlAmdVesVoy').val(result.data[0].VesVoyID).trigger("change");
        //                $('#ddlAmdToLoc').val(result.data[0].NextPortID).trigger("change");
        //                $('#ddlAmdModeofTrans').val(result.data[0].ModeOfTransportID).trigger("change");
        //                $('#ddlAmdDepot').val(result.data[0].DepotID).trigger("change");
        //                $('#ddlAmdParty').val(result.data[0].CustomerID).trigger("change");
        //                $('#ddlAgency').val(result.data[0].AgencyID).trigger("change");
        //                $('#ddlAmdBLNumber').val(result.data[0].BLID).trigger("change");

        //                //$scope.ddlAmdVesVoy = { ID: result.data[0].VesVoyID };
        //                 // $scope.ddlAmdToLoc = { ID: result.data[0].NextPortID };
        //               // $scope.ddlAmdModeofTrans = { ID: result.data[0].ModeOfTransportID };
        //               // $scope.ddlAmdDepot = { ID: result.data[0].DepotID };
        //               // $scope.ddlAmdBLNumber = { ID: result.data[0].BLID };
        //                //$scope.ddlAmdParty = { ID: result.data[0].CustomerID };
        //               // $scope.ddlAgency = { ID: result.data[0].AgencyID };

        //            }
        //            else {
        //                $scope.txtAmdDtMovement = "";
        //                $scope.ddlAmdVesVoy = "";
        //               // $scope.ddlAmdFromLoc = "";
        //                $scope.ddlAmdToLoc = "";
        //                $scope.ddlAmdModeofTrans = "";
        //                $scope.ddlAmdDepot = "";
        //                $scope.ddlAmdBLNumber = "";
        //                $scope.ddlAmdParty = "";

        //            }
        //        });
        //    });

        //}

        $scope.DeleteLastMove = function (txnid, cntrid,statuscode) {

            if (localStorage.getItem("UserID") == "1" || localStorage.getItem("UserID") == "23" || localStorage.getItem("UserID") == "24" || localStorage.getItem("UserID") == "27") {

                var Data = {};
                Data.CntrID = cntrid;
                Data.ID = txnid;
                Data.Statuscode = statuscode;
                Data.AgencyID = localStorage.getItem("AgencyID");
                Data.UserID = localStorage.getItem("UserID");
                $http({
                    method: 'POST',
                    url: '/api/ContainerApi/ValidateAgencyLastMove/',
                    data: JSON.stringify(Data),

                })
                    .then(function (response) {
                        $timeout(function () {
                            $scope.Result = response.data;

                            if (localStorage.getItem("AgencyID") == response.data[0].AgencyID) {

                                var BussData = {};
                                BussData.CntrID = cntrid;
                                BussData.ID = txnid;
                                BussData.Statuscode = statuscode;
                                BussData.AgencyID = localStorage.getItem("AgencyID");
                                BussData.UserID = localStorage.getItem("UserID");

                                $http({
                                    method: 'POST',
                                    url: "/api/ContainerApi/LastMoveRemoveandUpdate",
                                    data: JSON.stringify(BussData),
                                }).then(function (result) {
                                    $timeout(function () {
                                        if (result.data.length > 0) {
                                            ShowPopup("Error,Not Deleted");
                                        }
                                        else {

                                            ShowPopup("Movement Entry Deleted");
                                            $scope.CntrTrackingViewRecords();
                                        }

                                        setTimeOut(function () {
                                            window.location = "/";
                                        }, 3000);
                                    });
                                }, function (result) {
                                    if (result.status == 500) {
                                        ShowPopup("Sorry no internet connectivity Application Error.");
                                    }
                                    else if (result.status == 404) {
                                        ShowPopup("Sorry no internet connectivity page not found.");
                                    }


                                    if (result.status > 0) {
                                        var errorMsg = result.status + ': ' + result.data;
                                        // $(".modal").hide();
                                        ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                                    }
                                }).catch(function (result) {
                                    // This is set in the event of an error.
                                    console.log(result);
                                    ShowPopup('There has been an error: ' + result);
                                });

                            }
                            else {
                                ShowPopup("Cannot delete movement, Agency or UserID are different");
                                return false;


                            }


                        });
                    }, function (response) {
                        if (response.status > 0) {

                            var errorMsg = response.status + ': ' + response.data;
                            ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                        }
                    });
            }
            else {
                ShowPopup("Delete Restricted,Please Contact EQC Team");
            }

        }

        $scope.AmendUpdateSave = function () {
            var validation = "";

            var TxnsId = $scope.HDTxnsId;
            if (TxnsId == undefined) {

                validation += "<span style='color:red;'>*</span> <span>Please Edit Any Containers</span></br>"
            }
            if (validation != "") {

                ShowPopup(validation);
                return false;
            }
            var DataVal = {}
            var ItemsV = [];
            var Id = $scope.HDRegId;
            ItemsV.push(Id);
            DataVal.CntrID = $scope.HDCntrId;
            //DataVal.Status = $("#ddlToStatuscode option:selected").text();
            DataVal.DtMovement = $('#txtAmdDtMovement').val();
            $http({
                method: 'POST',
                url: '/api/ContainerApi/TrackingCntrDtMovementValidation/',
                data: JSON.stringify(DataVal),
            }).then(function (result) {

                var getdate = moment.utc(result.data[0].CurrentDate).local().format('MMM DD YYYY h:mm A');
                var SelectedDate = moment.utc(result.data[0].SelectedDate).local().format('MMM DD YYYY h:mm A');

                if (Date.parse(SelectedDate) >= Date.parse(getdate)) {
                    validation += "<span style='color:red;'>*</span> <span>Date of Movement should not be greater than CurrentDate.</span></br>"
                }

                if (validation != "") {

                    ShowPopup(validation);
                    return false;
                }
                var BussData = {}
                var id = $scope.HDTxnsId;

                if (id == "" || id == null)
                    BussData.ID = 0;
                else
                    BussData.ID = $scope.HDTxnsId

                BussData.DtMovement = $("#txtAmdDtMovement").val();
                BussData.UserID = localStorage.getItem("UserID");
                BussData.CntrID = $scope.HDCntrId;
                BussData.VesVoyID = $("#ddlAmdVesVoy").val();
                //BussData.LocationID = $("#ddlAmdFromLoc").val();
                BussData.NextPortID = $("#ddlAmdToLoc").val();
                BussData.ModeOfTransportID = $("#ddlAmdModeofTrans").val();
                BussData.DepotID = $("#ddlAmdDepot").val();
                BussData.BLID = $("#ddlAmdBLNumber").val();
                BussData.CustomerID = $("#ddlAmdParty").val();
                BussData.AgencyID = $("#ddlAgency").val();
                $http({
                    method: 'POST',
                    url: "/api/ContainerApi/AmendmentUpdateCntrTxns",
                    data: JSON.stringify(BussData),

                }).then(function (result) {
                    $timeout(function () {
                        $scope.CntrTrackingViewRecords();
                        $scope.IsVisible = false;
                        if (result.data.length > 0) {
                            ShowPopup("Error,Not Saved");

                        }
                        else {

                            ShowPopup("Amended Successfully");
                        }

                        setTimeOut(function () {
                            window.location = "/";
                        }, 3000);
                    });
                }, function (result) {
                    if (result.status == 500) {
                        ShowPopup("Sorry no internet connectivity Application Error.");
                    }
                    else if (result.status == 404) {
                        ShowPopup("Sorry no internet connectivity page not found.");
                    }


                    if (result.status > 0) {
                        var errorMsg = result.status + ': ' + result.data;
                        // $(".modal").hide();
                        ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                    }
                }).catch(function (result) {
                    // This is set in the event of an error.
                    console.log(result);
                    ShowPopup('There has been an error: ' + result);
                });
            });
           }

         $scope.btnExcel = function () {

             var CntrID = $("#ddlCntrNo").val();
               var TypeID = $("#ddlSizeType").val();
             var User = localStorage.getItem("UserName");

             window.location.href = '@Url.Action("InventoryTrackingExcel", "ContainersExcel")?CntrID=' + CntrID + "&TypeID=" + TypeID + "&User=" + User;

        }
    });

    function ShowPopup(message) {
        swal(message);
    };

</script>
<style>
    .btn.searchbtn {
        padding: 12px 21px;
    }

        .btn.searchbtn.btn-rose {
            float: left;
        }

        .btn.searchbtn.btn-danger {
            margin-left: 0;
        }

    .table > tbody > tr > td {
        white-space: nowrap;
    }

    .exceldownload .fa-file-excel-o {
        color: #4caf50;
        font-weight: 400;
        font-size: 20px;
    }

    .exceldownload a {
        color: #000;
    }
</style>

<div ng-app="MyApp" ng-controller="MyController">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 backbtn" style="text-align:right;">
                <button type="submit" ng-click="AddNew();" class="btn btn-fill btn-success btn-round btntop">
                    <i class="material-icons">reply</i> Back

                </button>

            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="card-header card-header-primary card-header-text">
                        <div class="card-text">
                            <h4 class="card-title">INVENTORY TRACKING & AMENDMENT </h4>
                        </div>
                    </div>
                    <div class="card-body ">
                        <div class="row" style="border:1px solid #ccc;">

                            <div class="col-md-12" style="border:1px solid #ccc;">
                                <div class="row">
                                    <div class="col-md-4" style="border-right:1px solid #ccc;">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Container Number</label>
                                                    <select class="form-control my-select" ng-model="ddlCntrNo" id="ddlCntrNo" ng-options="item.CntrNo for item in CntrNoList track by item.ID">
                                                    </select>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4" style="border-right:1px solid #ccc;">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Container Size Type </label>
                                                    <select disabled class="form-control my-select" ng-model="ddlSizeType" id="ddlSizeType" ng-options="item.Size for item in CntrSizeTypes track by item.TypeID" required>
                                                    </select>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="row">
                                            <div class="col-md-12" style="margin-top:30px;">
                                                <button type="submit" ng-click="CntrTrackingViewRecords();" class="btn btn-fill btn-rose" style="width:32%;">
                                                    <i class="material-icons">search</i>
                                                    Search
                                                </button>

                                                <button type="submit" ng-click="ClearRecords();" class="btn btn-fill btn-primary" style="width:32%;">
                                                    <i class="material-icons"></i>
                                                    Clear
                                                </button>
                                                <button type="submit" ng-click="AmendUpdateSave();" class="btn btn-fill btn-warning" style="width:32%;">
                                                    <i class="material-icons"></i>
                                                    AMEND
                                                </button>
                                                <input type="hidden" id="HDTxnsId" ng-model="HDTxnsId" />
                                                <input type="hidden" id="HDCntrId" ng-model="HDCntrId" />
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-12 exceldownload" style="margin-right:30px;text-align:right;">
                            <a ng-click="btnExcel();">Download <i class="fa fa-file-excel-o"></i></a>
                        </div>
                        <div class="col-md-12" style="padding-left: 19px; padding-right:19px;">
                            <div class="material-datatables" style="border: 1px solid #ccc; padding: 5px; overflow:scroll;height:360px;">

                                <table class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th class="disabled-sorting text-right"></th>

                                            <th>Container No</th>
                                            <th>Size Type</th>
                                            <th>Status</th>
                                            <th>Move Dt</th>
                                            <th>Agency</th>
                                            <th> Location</th>
                                            <th>Vessel/Voyage</th>
                                            <th>Transit </th>
                                            <th>Depot</th>
                                            <th>BL Number</th>
                                            <th>Customer</th>
                                            <th class="disabled-sorting text-right">Actions</th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        <tr ng-repeat="i in CntrTxnsRec | filter : paginate | orderBy:'-Statusv'">
                                            <td class="td-actions text-right">
                                                <button ng-show="ShowOnlyForCntrSearch" ng-if="$first" id="Btndelete"
                                                        type="button" rel="tooltip" class="btn btn-danger btn-round" data-original-title="" title="" ng-click="DeleteLastMove(i.TxnsID,i.CntrID,i.StatusCode)">
                                                    <i class="material-icons">clear</i>
                                                </button>
                                            </td>

                                            <td>{{i.CntrNo}}</td>
                                            <td>{{i.Size}}</td>
                                            <td>{{i.StatusCode}}</td>
                                            <td>{{i.DtMovement}}</td>
                                            <td>{{i.AgencyName}}</td>
                                            <td>{{i.FromPort}}</td>
                                            <td>{{i.VesVoy}}</td>
                                            <td>{{i.TransitMode}}</td>
                                            <td>{{i.Depot}}</td>
                                            <td>{{i.BLNumber}}</td>
                                            <td>{{i.CustomerName}}</td>
                                            <td class="td-actions text-right">

                                                <button type="button" rel="tooltip" class="btn btn-warning btn-round" data-original-title="" title="" ng-click="AmendmentEdit(i.TxnsID,i.CntrID,i.AgencyID)">
                                                    <i class="material-icons">edit</i>
                                                </button>

                                            </td>

                                        </tr>
                                    </tbody>
                                </table>
                                <div id="notFoundDiv" ng-show="(CntrTxnsRec|filter:CntrNo).length==0" style="color: red; font-weight: bold">No Records Found</div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body" ng-show="IsVisible">
                        <div class="row" style="border:1px solid #ccc; padding:10px;">

                            <div class="col-md-12">
                                @*style="border-top: 1px dashed #4c4b4b;padding-top:10px;"*@
                                <h5 class="cardtitle">AMENDMENT DETAILS</h5>

                            </div>
                            <div class="col-md-12" style="text-align:right;">
                                <span style="margin-left: 100px; color: #e91e63; font-size:14px; padding-right: 38px;">StatusCode :</span>
                                <span style="color: #e91e63; font-size:14px;" ng-bind="StatusCode"> </span>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>  Movement Date</label>

                                            <input type="datetime-local" id="txtAmdDtMovement" ng-model="txtAmdDtMovement" class="form-control">
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>Vessel/Voyage</label>
                                            <select class="form-control my-select" ng-model="ddlAmdVesVoy" id="ddlAmdVesVoy" ng-options="item.VesVoy for item in VesVoyList track by item.ID" required></select>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label> Location </label>
                                            <select class="form-control my-select" ng-model="ddlAmdToLoc" id="ddlAmdToLoc" ng-options="item.PortName for item in PortList track by item.ID" required>
                                            </select>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>Transit Mode </label>

                                            <select class="form-control my-select" ng-model="ddlAmdModeofTrans" id="ddlAmdModeofTrans" ng-options="item.GeneralName for item in TransitModeList track by item.ID" required> </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>Depot</label>
                                            <select class="form-control my-select" ng-model="ddlAmdDepot" id="ddlAmdDepot" ng-options="item.DepotName for item in DepotValue track by item.ID">
                                            </select>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>BL Number</label>
                                            <select class="form-control my-select" id="ddlAmdBLNumber" ng-model="ddlAmdBLNumber" ng-options="item.BLNumber for item in BLAllValues track by item.ID"></select>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>Customer Name</label>
                                            <select class="form-control my-select" ng-model="ddlAmdParty" id="ddlAmdParty" ng-options="item.CustomerName for item in PartyValues track by item.ID" required>
                                            </select>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label>Agency</label>
                                            <select class="form-control my-select" ng-model="ddlAgency" id="ddlAgency" ng-options="item.AgencyName for item in AgencyList track by item.ID" required>
                                            </select>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $('.my-select').select2({
            placeholder: "--Select--",
            allowClear: true,
            width: '100%'
        });
    });

</script>
