@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<style>
    .btn {
        position: relative;
        padding: 8px 10px;
    }

    .btndrop {
        width: 100%;
        margin-top:-2px;
    }

    .dropdown-toggle:after {
        margin-left: 5.255em !important;
    }

    .rightbox .form-group {
        padding-bottom: 0;
    }

    .slotbox .form-group .form-control {
        height: 27px;
    }

    .slotbox .form-group select.form-control {
        height: 27px;
    }
    .form-control {
        padding: 0;
    }
</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.min.js"></script>
<script type="text/javascript">

    LayoutApp.controller('MyController', function ($scope, $http, $timeout) {

        $("#overlay").show();

       

        $(document).ready(function () {
            $('.my-select').select2({
                placeholder: "--Select--",
                allowClear: true,
                width: '100%'
            });
        });

        $scope.RegRRId = 0;
        $scope.IsddlCntrTypes = true;
        $scope.IsSlotdisable = true;
        $scope.StatusCodeVaues = "DRAFT";
        document.getElementById('txtDate').value = new Date().toISOString().slice(0, 10);
        document.getElementById("txtNoOf20").disabled = true;
        document.getElementById("txtNoOf40").disabled = true;
        

        $scope.PortAllvalues = null;
        $scope.fillPortsValues = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.PortAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillPortsValues();

        $scope.CityAllvalues = null;
        $scope.fillCityValues = function () {
            $http({
                method: 'POST',
                url: '/api/Home/cityBind/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CityAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCityValues();

        $scope.SlotTermsValue = null;
        $scope.fillSlotTermsValues = function () {
            var Datavalue = {};
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/SlotTremsValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.SlotTermsValue = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillSlotTermsValues();

        $scope.ShipmentTypeAllvalues = null;
        $scope.fillShipmentTypeValues = function () {
            var Datavalue = {};
            Datavalue.ID = "1"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipmentTypeAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipmentTypeValues();

        $scope.LinerPrefixAllvalues = null;
        $scope.fillLinerPrefixValues = function () {
            var Datavalue = {};
            Datavalue.ID = "66"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.LinerPrefixAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillLinerPrefixValues();

        $scope.CommodityValue = null;
        $scope.fillCommodityValues = function () {

            
            var Datavalue = {};
            Datavalue.ID = "2"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)

            }).then(function (result) {
                $timeout(function () {
                    $scope.CommodityValue = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCommodityValues();

        $scope.ServiceTypesValue = null;
        $scope.fillServiceTypesValues = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ServiceTypesValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.ServiceTypesValue = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillServiceTypesValues();

        $scope.ShipmentTypeAllvalues = null;
        $scope.fillShipmentTypeValues = function () {
            var Datavalue = {};
            Datavalue.ID = "1"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipmentTypeAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipmentTypeValues();

        $scope.UserNameMasterAllvalues = null;

        $scope.fillUserMasterValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/UserMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.UserNameMasterAllvalues = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillUserMasterValues();

        $scope.BookingPartyAllvalues = null;
        $scope.fillBookingPartyValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.BookingPartyAllvalues = result.data;
                    $("#overlay").hide();
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBookingPartyValues();

        $scope.ShipperAllvalues = null;
        $scope.fillShipperValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipperAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipperValues();

        $scope.VesselNameAllvalues = null;
        $scope.fillVesselNameValues = function () {
            var Datavalue = {};
            Datavalue.AgencyID = localStorage.getItem("AgencyID");
            $http({
                method: 'POST',
                url: '/api/Home/VesVoyMasterByAgency/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $scope.VesselNameAllvalues = result.data;
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillVesselNameValues();

        

        $scope.ChekBoxRRate = function (RRIDv) {
           
            $('#demoModal').modal('hide');
            var Datavalue = {};
            Datavalue.RRID = RRIDv;
            $http({
                method: 'POST',
                url: '/api/SalesApi/RateSheetExistingMasterRecord',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {
                $timeout(function ()
                {
                    $scope.PortAgentDetails(result.data[0].PlaceofDischargeId);
                    $scope.HDRRID = result.data[0].ID;
                    $scope.txtRRNo = result.data[0].RatesheetNo;
                    $scope.ddlBookingParty = { ID: result.data[0].BookingPartyID };
                    $scope.ddlSalesPerson = { ID: result.data[0].SalesPersonID };
                    $scope.ddlShipmentType = { ID: result.data[0].ShipmentID };
                    $scope.ddlPOO = { ID: result.data[0].PortOfOrgin };
                    $scope.ddlPOL = { ID: result.data[0].PortOfLoading };
                    $scope.ExistingddlPOL(result.data[0].PortOfLoading);
                    $scope.ddlExportHaulage = { ID: result.data[0].ExpHaulageID };
                    $scope.ddlPOD = { ID: result.data[0].PlaceofDischargeId };
                    $scope.ddlFPOD = { ID: result.data[0].FinalPODId };
                    $scope.ddlImportHaulage = { ID: result.data[0].ImpHaulageId };
                    $scope.ddlTSPort = { ID: result.data[0].TranshimentPortID };
                    $scope.ddlServiceType = { ID: result.data[0].ServiceTypeID };
                    //$scope.txtValidTill = result.data[0].ValidTill;
                    $scope.txtRemarks = result.data[0].Remarks;
                    $scope.ddlShipper = { ID: result.data[0].ShipperID };
                    $('#txtValidTill').val(result.data[0].ValidTill);
                    $scope.CntrButtonshow = false;
                    $scope.CntrButtonDeleteshow = true;
                    $scope.HDSlotPrincible = result.data[0].SlotPrincipal;
                    $scope.ddlSlotTerm = { ID: result.data[0].SlotTermID };
                    
                    if (result.data[0].SlotPrincipal == 1) {
                        $scope.IsSlotdisable = true;
                    }
                    else {
                        $scope.IsSlotdisable = false;
                    }


   
                   
                    if (result.data[0].TranshimentPortID == "0")
                    {
                        document.getElementById("ddlTSPort").disabled = true;
                        document.getElementById("btnTranship").style.display = "none";
                        document.getElementById("ddlTranshipmentAgent").disabled = true;

                        /* $("#ddlTSPort").val(null).trigger("change");*/
                    }
                    else {
                        $scope.TranshimentAgent(result.data[0].TranshimentPortID);
                    }


                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }

        $scope.ChekBoxRRateCntrTypes = function (RRIDv)
        {
            var Datavalue = {};
            Datavalue.RRID = RRIDv;
            $http({
                method: 'POST',
                url: '/api/SalesApi/RateSheetBookingCntrTypes',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {
                $timeout(function () {

                    if (result.data[0].CntrType != "") {
                        $scope.DynamicGridCntr.splice(0, 1);
                    }

                    angular.forEach(result.data, function (value, key)
                    {
                        $scope.DynamicGridCntr.push({
                            'BID': result.data[key].BID,
                            'CntrTypeID': { ID: result.data[key].CntrTypeID },
                            'Qty': result.data[key].Qty,
                            'CommodityType': { ID: result.data[key].CommodityTypeID}

                        });

                    });

                    console.log($scope.DynamicGridCntr);

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }

        $scope.CntrTypesvalues = null;
        $scope.fillCntrTypeValues = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CntrTypeValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrTypesvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCntrTypeValues();



        $scope.DynamicGridCntr = [{ BID: "", CntrTypeID: "", Qty: "", CommodityType:"" }];
        $scope.CntrTypesRowAdd = function (DynamicGridCntr)
        {
            if ($scope.RegRRId == 0) {
                if (DynamicGridCntr.Qty == "") {
                    swal("Please enter CntrTypes");
                    return;
                }
                $scope.DynamicGridCntr.push({
                    'BID': "",
                    'CntrTypeID': "",
                    'Qty': "",
                    'CommodityType': ""
                });
            }
        }

        $scope.DynamicGridTsPort = [{ PortID: "", TsAgencyID:"" }];

        $scope.AdditionTSPortAdd = function (DynamicGridTsPort) {

            if (DynamicGridTsPort.PortID == "") {
                swal("Please select T/S Port");
                return;
            }

            $scope.DynamicGridTsPort.push({
                'PortID': "",
                'TsAgencyID':""


            });

        }

        $scope.AdditionTSPortAddRemove = function (DynamicGridTsPort, index) {
            $scope.DynamicGridTsPort.splice(index, 1);

        }
   


        $scope.SaveRecord = function (data, TSPortData) {

            var validation = "";
            var ddlLinePrefix = $('#ddlLinePrefix').val();
            if (ddlLinePrefix == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select LinePrefix</span></br>"
            }

            var ddlbookingParty = $('#ddlBookingParty').val();
            if (ddlbookingParty == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Booking Party</span></br>"
            }

            var ddlShipmentType = $('#ddlShipmentType').val();
            if (ddlShipmentType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select ShipmentTypes</span></br>"
            }

            var ddlPortofLoading = $('#ddlPOL').val();
            if (ddlPortofLoading == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Loading</span></br>"
            }

            var ddlPortofDischarge = $('#ddlPOD').val();
            if (ddlPortofDischarge == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Discharge</span></br>"
            }


            var ddlSalesPerson = $('#ddlSalesPerson').val();
            if (ddlSalesPerson == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please select Sales Person</span></br>"
            }

            var ddlServiceType = $('#ddlServiceType').val();
            if (ddlServiceType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Service Types</span></br>"
            }
            var ddlCommodityType = $('#ddlCommodityType').val();
            if (ddlCommodityType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Commodity</span></br>"
            }
            var ddlSalesPerson = $('#ddlSalesPerson').val();
            if (ddlSalesPerson == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port Sales Person</span></br>"
            }

            var ddlCarrier = $('#ddlCarrier').val();
            if (ddlCarrier == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Carrier</span></br>"
            }


            var ddlShipper = $('#ddlShipper').val();
            if (ddlShipper == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Shipper</span></br>"
            }
            var ddlPickUpDepot = $('#ddlPickUpDepot').val();
            if (ddlPickUpDepot == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select PickupDepot</span></br>"
            }

            var txtValidTill = $('#txtValidTill').val();
            if (txtValidTill.length == 0) {
                validation += "<span style='color:red;'>*</span> <span>Please Enter ValidTill Date</span></br>"
            }

            var ddlTSPort = $("#ddlTSPort").val();

            if (ddlTSPort != "?" && ddlTSPort != null) {

                var ddlTranshipmentAgent = $('#ddlTranshipmentAgent').val();
                if (ddlTranshipmentAgent == "?") {
                    validation += "<span style='color:red;'>*</span> <span>Please Select Transhipment Agent</span></br>"
                }
            }

            var ddlDestinationAgent = $('#ddlDestinationAgent').val();
            if (ddlDestinationAgent == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Destination Agent</span></br>"
            }
            //var ddlVesVoy = $('#ddlVesVoy').val();
            //if (ddlVesVoy == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Vessel/Voyage</span></br>"
            //}

            //var ddlslot = $('#ddlslot').val();
            //if (ddlslot == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Slot Operator</span></br>"
            //}

            //var ddlslotContract = $('#ddlslotContract').val();
            //if (ddlslotContract == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Slot Contact</span></br>"
            //}
            if (typeof $scope.HDRRID != "undefined" &&  $scope.HDRRID != "0") {

                if ($scope.HDSlotPrincible == 1) {

                }
                else {
                    var ddlSlotTerm = $('#ddlSlotTerm').val();
                    if (ddlSlotTerm == "?") {
                        validation += "<span style='color:red;'>*</span> <span>Please Select Slot Terms</span></br>"
                    }
                }
            }

            var ddlPreparedBy = $('#ddlPreparedBy').val();
            if (ddlPreparedBy == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select PreparedBy</span></br>"
            }

            var Noof20 = $('#txtNoOf20').val();
            var Noof40 = $('#txtNoOf40').val();
            if (Noof20 == "" && Noof40 == "") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Container Qty</span></br>"
            }


            if (validation != "") {
                ShowPopup(validation);
                return false;
            }

            $("#overlay").show();
            var BussData = {}
            var Items = [];
            var TranshimentPort = [];
            if ($scope.RegId == "")
                BussData.ID = 0;
            else
                BussData.ID = $scope.RegId;
            BussData.BookingNo = $scope.txtBookingNo;
            BussData.BkgDate = $("#txtDate").val();
            BussData.RRID = $scope.HDRRID;
            BussData.RRNo = $scope.txtRRNo;
            BussData.SlotRefNo = $scope.txtSlotRef;
            BussData.LinePrefixID = $("#ddlLinePrefix").val();
            BussData.LinePrefix = $("#ddlLinePrefix option:selected").text();
            BussData.BkgPartyID = $("#ddlBookingParty").val();
            BussData.BkgParty = $("#ddlBookingParty option:selected").text();
            BussData.ShipmentTypeID = $("#ddlShipmentType").val();
            BussData.ShipmentType = $("#ddlShipmentType option:selected").text();

            BussData.DirectBKg = $scope.DirectBKg;

            if ($("#ddlPOO").val() != "?") {
                BussData.POOID = $("#ddlPOO").val();
                BussData.POO = $("#ddlPOO option:selected").text();
            }
            else {

                BussData.POOID = 0;
                BussData.POO = "";
            }

            BussData.POLID = $("#ddlPOL").val();
            BussData.POL = $("#ddlPOL option:selected").text();

            BussData.PODID = $("#ddlPOD").val();
            BussData.POD = $("#ddlPOD option:selected").text();

            if ($("#ddlFPOD").val() != "?") {
                BussData.FPODID = $("#ddlFPOD").val();
                BussData.FPOD = $("#ddlFPOD option:selected").text();
            }
            else {

                BussData.FPODID = 0;
                BussData.FPOD = "";
            }



            BussData.ServiceTypeID = $("#ddlServiceType").val();
            BussData.ServiceType = $("#ddlServiceType option:selected").text();
            BussData.CommodityTypeID = $("#ddlCommodityType").val();
            BussData.CommodityType = $("#ddlCommodityType option:selected").text();
            BussData.SalesPersonID = $("#ddlSalesPerson").val();
            BussData.SalesPerson = $("#ddlSalesPerson option:selected").text();
            BussData.CarrierID = $("#ddlCarrier").val();
            BussData.Carrier = $("#ddlCarrier option:selected").text();

            //BussData.VesVoyID = $("#ddlVesVoy").val();
            //BussData.VesVoy = $("#ddlVesVoy option:selected").text();

            BussData.ShipperID = $("#ddlShipper").val();
            BussData.Shipper = $("#ddlShipper option:selected").text();
            BussData.PickUpDepotID = $("#ddlPickUpDepot").val();
            BussData.PickUpDepot = $("#ddlPickUpDepot option:selected").text();
            BussData.ValidTill = $("#txtValidTill").val();
            if ($("#ddlTSPort").val() != "?") {
                BussData.TSPort = $("#ddlTSPort option:selected").text();
                BussData.TSPortID = $("#ddlTSPort").val();
                BussData.TranshipmetAgentID = $("#ddlTranshipmentAgent").val();

            }
            else {
                BussData.TSPort = "";
                BussData.TSPortID = 0;
                BussData.TranshipmetAgentID = 0;
            }

            BussData.DestinationAgent = $("#ddlDestinationAgent option:selected").text();
            BussData.DestinationAgentID = $("#ddlDestinationAgent").val();


            BussData.PortNtRef = $scope.PortNtRef;
            BussData.UserID = localStorage.getItem("UserID");
            BussData.AgentId = localStorage.getItem("AgencyID");
            BussData.SessionFinYear = new Date().getFullYear();
            BussData.AgentCode = localStorage.getItem("DocumentSuffix");
            BussData.Remarks = $scope.txtRemarks;
            BussData.PreparedBYID = $("#ddlPreparedBy").val();
            BussData.PreparedBY = $("#ddlPreparedBy option:selected").text();

            if ($("#ddlVesVoy").val() != "?") {
                BussData.VesVoyID = $("#ddlVesVoy").val();
                BussData.VesVoy = $("#ddlVesVoy option:selected").text();
            }
            else {

                BussData.VesVoyID = 0;
                BussData.VesVoy = "";
            }
            if ($("#ddlslot").val() != "?")
                BussData.SlotOperatorID = $("#ddlslot").val();
            else
                BussData.SlotOperatorID = 0;
            //if ($("#ddlslotContract").val() != "?")
            //    BussData.SlotID = $("#ddlslotContract").val();
            //else
                BussData.SlotID = 0;

            if ($scope.txtNoOf20 != "")
                BussData.CTQ20 = $scope.txtNoOf20;
            else
                BussData.CTQ20 = 0;
            if ($scope.txtNoOf40 != "")
                BussData.CTQ40 = $scope.txtNoOf40;
            else
                BussData.CTQ40 = 0;

            if (typeof $scope.txtslot20 != "undefined" && $scope.txtslot20 != "")
                BussData.Cnt20 = $scope.txtslot20;
            else
                BussData.Cnt20 = 0;

            if (typeof $scope.txtslot40 != "undefined" && $scope.txtslot40 != "")
                BussData.Cnt40 = $scope.txtslot40;
            else
                BussData.Cnt40 = 0;

            if ($("#ddlSlotTerm").val() != "?")
                BussData.SlotTermID = $("#ddlSlotTerm").val();
            else
                BussData.SlotTermID = 0;

            angular.forEach(data, function (value, key) {
                var BLIDV = 0;
                if (typeof data[key].BID == "undefined")
                    BLIDV = 0;
                else
                    BLIDV = data[key].BID;

                Items.push('Insert:' + BLIDV, data[key].CntrTypeID.ID, data[key].Qty, data[key].CommodityType.ID);
            });
            BussData.Itemsv = Items.toString();

            console.log(TSPortData);
           
            angular.forEach(TSPortData, function (value, key)
            {
                var ddlTsPortAgencyValues = $("#ddlTsPortAgencyValues" + key).val();
                if (typeof TSPortData[key].PortID.ID != "undefined")
                    TranshimentPort.push('Insert:' + TSPortData[key].PortID.ID, ddlTsPortAgencyValues);

            });
            BussData.TranshimentPort = TranshimentPort.toString();


            $("#overlay").hide();
            swal.fire({
                title: "Please ensure the slot Rate if its correct then ",
                text: "",
                icon: 'success',
                showCancelButton: true,
                showConfirmButton: true,
                confirmButtonText: 'Proceed!',
                cancelButtonText: 'Reject!'
            }).then((result) => {
                if (result.value == true) {

                    $http({
                        method: 'POST',
                        url: '/api/DocumentApi/BookingInsert',
                        data: JSON.stringify(BussData),

                    }).then(function (result) {
                        $timeout(function () {
                            if (result.data.length > 0) {
                                $("#overlay").hide();
                                $scope.RegId = result.data[0].ID;
                                $scope.txtBookingNo = result.data[0].BookingNo;
                                $scope.FilBookingExistingDetails($scope.RegId);
                                ShowAlert(result.data[0].AlertMessage);

                                //ShowPopup("Booking Saved Successfully");
                            }
                            else {
                                $("#overlay").hide();
                                ShowPopup(result.data[0].AlertMessage);
                            }
                            //var url = "/Document/BookingSearch";
                            //window.location.href = url;
                            setTimeOut(function () {
                                window.location = "/";
                            }, 3000);
                        });
                    }, function (result) {
                        if (result.status == 500) {
                            ShowPopup("Sorry no internet connectivity Application Error.");
                        }
                        else if (result.status == 404) {
                            ShowPopup("Sorry no internet connectivity page not found.");
                        }
                        if (result.status > 0) {
                            var errorMsg = result.status + ': ' + result.data;
                            ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                        }
                    }).catch(function (result) {

                        ShowPopup('There has been an error: ' + result);
                    });
                }
                else {
                    swal.fire("Reject!", "Change the Slot Rate and then save!", "warning");

                }
            });

        }



        $(document).ready(function () {

            var queryString = new Array();
            if (window.location.search.split('?').length > 1) {
                var params = window.location.search.split('?')[1].split('&');
                for (var i = 0; i < params.length; i++) {
                    var key = params[i].split('=')[0];
                    var value = decodeURIComponent(params[i].split('=')[1]);
                    queryString[key] = value;
                }
            }
            if (queryString["BkgRegID"] != null)
            {
                $("#overlay").show();
                $scope.RegId = queryString["BkgRegID"].toString();
                document.getElementById("ddlBookingParty").disabled = true;
                document.getElementById("ddlSalesPerson").disabled = true;
                document.getElementById("ddlPOL").disabled = true;
                document.getElementById("ddlPOD").disabled = true;
                document.getElementById("ddlServiceType").disabled = true;
                document.getElementById("ddlShipmentType").disabled = true;
                $scope.FilBookingExsitingMaster(queryString["BkgRegID"].toString());
                $scope.FilBookingExistingDetails(queryString["BkgRegID"].toString());
                $scope.FilBkgTsPortExsitingMaster(queryString["BkgRegID"].toString());
                $scope.CntrButtonshow = false;
            }
            else {
                document.getElementById('txtValidTill').value = new Date().toISOString().slice(0, 10);
                $scope.ddlPreparedBy = { ID: localStorage.getItem("UserID") };

            }
            if (queryString["BkgRRID"] != null) {

                if (queryString["BkgRRID"].toString() != "0")
                {
                    $scope.RegRRId = queryString["BkgRRID"].toString();
                    document.getElementById("ddlBookingParty").disabled = true;
                    document.getElementById("ddlSalesPerson").disabled = true;
                    document.getElementById("ddlPOL").disabled = true;
                    document.getElementById("ddlPOD").disabled = true;
                    document.getElementById("ddlServiceType").disabled = true;
                    document.getElementById("ddlShipmentType").disabled = true;
                    $scope.ChekBoxRRate(queryString["BkgRRID"].toString());
                    $scope.ChekBoxRRateCntrTypes(queryString["BkgRRID"].toString());
                    $scope.FilRateSheetTsPortExsitingMaster(queryString["BkgRRID"].toString())
                    
                }
                else {

                    if (queryString["BkgDirect"] != null)
                        $scope.DirectBKg = queryString["BkgDirect"].toString();
                    else
                        $scope.DirectBKg = 0;

                    $scope.CntrButtonshow = true;
                    $scope.IsddlCntrTypes = false;
                    $scope.IsSlotdisable = false;
                    document.getElementById('txtValidTill').value = new Date().toISOString().slice(0, 10);
                    $scope.ddlPreparedBy = { ID: localStorage.getItem("UserID") };
                    document.getElementById('DivRRvisible').style.visibility = 'hidden';
                    document.getElementById('DivSlatvisible').style.visibility = 'hidden';
                   
                }

            }

        });

        $scope.FilBookingExsitingMaster = function (BkgRegID) {
            $("#overlay").show();
            var Datavalue = {};
            Datavalue.ID = BkgRegID;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingExistingViewRecord',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {
                $timeout(function () {
                    $scope.ExistingSoltOperator(result.data[0].VesVoyID, result.data[0].RRID, result.data[0].DirectBKg);
                    $scope.ExistingSlotContact(result.data[0].SlotOperatorID, result.data[0].VesVoyID)
                    $scope.TranshimentAgent(result.data[0].TsPortID);
                    $scope.PortAgentDetails(result.data[0].PODID);
                    $scope.RegId = result.data[0].ID;
                    $('#txtDate').val(result.data[0].BkgDatev);
                    $('#txtValidTill').val(result.data[0].ValidTillv);


                    $scope.txtBookingNo = result.data[0].BookingNo;
                    $scope.txtRRNo = result.data[0].RRNo;
                    $scope.HDRRID = result.data[0].RRID;
                    $scope.txtSlotRef = result.data[0].SlotRefNo;
                    $scope.ddlBookingParty = { ID: result.data[0].BkgPartyID };
                    $scope.ddlShipmentType = { ID: result.data[0].ShipmentTypeID };
                    $scope.ddlPOO = { ID: result.data[0].POOID };
                    $scope.ddlPOL = { ID: result.data[0].POLID };
                    $scope.ExistingddlPOL(result.data[0].POLID);
                    $scope.ddlPOD = { ID: result.data[0].PODID };
                    $scope.ddlFPOD = { ID: result.data[0].FPODID };
                    $scope.ddlServiceType = { ID: result.data[0].ServiceTypeID };
                    $scope.ddlCommodityType = { ID: result.data[0].CommodityTypeID };
                    $scope.ddlSalesPerson = { ID: result.data[0].SalesPersonID };
                    $scope.ddlCarrier = { ID: result.data[0].CarrierID };
                    $scope.ddlVesVoy = { ID: result.data[0].VesVoyID };
                    $scope.ddlShipper = { ID: result.data[0].ShipperID };
                    $scope.PortNtRef = result.data[0].PortNtRef;

                    $scope.ddlCorPOL = { ID: result.data[0].POLID };
                    $scope.ddlCorPOD = { ID: result.data[0].PODID };

                    $scope.txtRemarks = result.data[0].Remarks;
                    $scope.ddlPickUpDepot = { ID: result.data[0].PickUpDepotID };
                    $scope.ddlPreparedBy = { ID: result.data[0].PreparedBYID };
                    $scope.txtNoOf20 = result.data[0].CTQ20;
                    $scope.txtNoOf40 = result.data[0].CTQ40;
                    $scope.ddlTSPort = { ID: result.data[0].TsPortID };
                    $scope.ddlDestinationAgent = { ID: result.data[0].DestinationAgentID };
                    $scope.txtslot20 = result.data[0].Cnt20;
                    $scope.txtslot40 = result.data[0].Cnt40;
                    $scope.ddlslot = { ID: result.data[0].SlotOperatorID };
                    //$scope.ddlslotContract = { ID: result.data[0].SlotID };
                    $scope.ddlSlotTerm = { ID: result.data[0].SlotTermID };
                    $scope.StatusCodeVaues = result.data[0].Status;
                    $scope.ddlTranshipmentAgent = { ID: result.data[0].TranshipmetAgentID };
                    $scope.ddlLinePrefix = { ID: result.data[0].LinePrefixID };
                    $scope.HDSlotPrincible = result.data[0].SlotPrincipal;
                    $scope.DirectBKg = result.data[0].DirectBKg;
                    if (result.data[0].SlotPrincipal == 1) {
                        $scope.IsSlotdisable = true;
                    }
                    else {
                        $scope.IsSlotdisable = false;
                    }
                
                    if (result.data[0].Status == "CONFIRM") {
                        document.getElementById("btnSave").style.display = "none";
                        document.getElementById("btnCancel").style.display = "none";
                        document.getElementById("btnConfirm").style.display = "none";
                        document.getElementById("btnRestore").style.display = "none";
                    }
                    if (result.data[0].Status == "DRAFT") {
                        document.getElementById("btnRestore").style.display = "none";
                        document.getElementById("btnEmail").style.display = "none";
                    }
                    if (result.data[0].Status == "CANCEL") {
                        document.getElementById("btnSave").style.display = "none";
                        document.getElementById("btnCancel").style.display = "none";
                        document.getElementById("btnConfirm").style.display = "none";
                        document.getElementById("btnPdf").style.display = "none";
                        document.getElementById("btnEmail").style.display = "none";
                      
                    }
                    if (result.data[0].TranshimentPort == "0")
                    {
                        
                        document.getElementById("ddlTSPort").disabled = true;
                        document.getElementById("btnTranship").style.display = "none";
                        document.getElementById("ddlTranshipmentAgent").disabled = true;
                        document.getElementById("ddlTranshipmentAgent").style.display = "none";
                        
                        if ($("#ddlTSPort").val() != "?") {
                            $("#ddlTSPort").val(null).trigger("change");
                        }
                    }
                    if (result.data[0].OnlineBkg == "0") {
                        document.getElementById("displayHid").style.display = "none";
                    }
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }

        $scope.FilBookingExistingDetails = function (BkgRegID)
        {
            var Datavalue = {};
            Datavalue.ID = BkgRegID;

            $http({
                method: 'POST',
                url: '/api/DocumentApi/BkgExistingCntrTypesViewRecord',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {
                $timeout(function () {


                    $scope.DynamicGridCntr.length = 0;
                    if (result.data.length > 0) {


                        angular.forEach(result.data, function (value, key) {
                            $scope.DynamicGridCntr.push({
                                'BID': result.data[key].BID,
                                'CntrTypeID': { ID: result.data[key].CntrTypeID },
                                'Qty': result.data[key].Qty,
                                'CommodityType': { ID: result.data[key].CommodityType }

                            });

                        });

                        console.log($scope.DynamicGridCntr);
                    }
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }

        $scope.setTotals = function (item)
        {
            var T20 = 0; var T40 = 0;
            $scope.txtNoOf20 = "";
            $scope.txtNoOf40 = "";
            console.log(item);
            angular.forEach(item, function (value, key) {
                if (item[key].CntrTypeID.ID == 1 || item[key].CntrTypeID.ID == 4 || item[key].CntrTypeID.ID == 6 || item[key].CntrTypeID.ID == 8 || item[key].CntrTypeID.ID == 11)
                    T20 += Number(item[key].Qty);
                else
                    T40 += Number(item[key].Qty);

            })
            $scope.txtNoOf20 = T20;
            $scope.txtNoOf40 = T40;
        }

        $scope.btnPrint = function () {
            var validation = "";
            var RegId = $scope.RegId;
            if (RegId == undefined) {
                validation += "<span stoyle='color:red;'>*</span> <span>Generate Booking after Print</span></br>"
            }
            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
           
           
            var id = $scope.RegId;
            var AgencyID = localStorage.getItem("AgencyID");
            var GeoLocID = localStorage.getItem("GeoLocationID");
          
            window.open('@Url.Action("BookingPDF", "BookingPDF")?id=' + id + '&AgencyID=' + AgencyID + '&GeoLocID=' + GeoLocID);

        }

        $scope.BookingConfirm = function ()
        {
            var validation = "";
            var ddlVesVoy = $('#ddlVesVoy').val();
            if (ddlVesVoy == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Vessel/Voyage</span></br>"
            }

            var ddlslot = $('#ddlslot').val();
            if (ddlslot == "?" || ddlslot == null) {
                validation += "<span style='color:red;'>*</span> <span>Please Select Slot Operator</span></br>"
            }

            var ddlSlotTerm = $('#ddlSlotTerm').val();
            if (ddlSlotTerm == "?" || ddlSlotTerm == null) {
                validation += "<span style='color:red;'>*</span> <span>Please update Slot Details</span></br>"
            }

            if ($scope.txtslot40 == "0.00" && $scope.txtslot20 == "0.00")
            {
                validation += "<span style='color:red;'>*</span> <span>Please update Slot Amount</span></br>"
            }

            //var ddlslotContract = $('#ddlslotContract').val();
            //if (ddlslotContract == "?" || ddlslotContract == null) {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Slot Contact</span></br>"
            //}
           
            var RegId = $scope.RegId;

            if (RegId == undefined) {
                validation += "<span style='color:red;'>*</span> <span>Generate Booking after confirm</span></br>"
            }
            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
            $("#overlay").show();
            var BussData = {}
            var CntrQtyItems = [];
            BussData.ID = $scope.RegId;
            BussData.IntStatus = 2;
            BussData.VesVoyID = $("#ddlVesVoy").val();
            BussData.VesVoy = $("#ddlVesVoy option:selected").text();
            BussData.SlotOperatorID = $("#ddlslot").val();
            //BussData.SlotID = $("#ddlslotContract").val();
            BussData.SlotID = 0;
            BussData.CountryID = localStorage.getItem("CountryID");
            if (typeof $scope.txtslot20 != "undefined" && $scope.txtslot20 != "")
                BussData.Cnt20 = $scope.txtslot20;
            else
                BussData.Cnt40 = 0;
            if (typeof $scope.txtslot40 != "undefined" && $scope.txtslot40 != "")
                BussData.Cnt40 = $scope.txtslot40;
            else
                BussData.Cnt40 = 0;
            if ($("#ddlSlotTerm").val() != "?")
                BussData.SlotTermID = $("#ddlSlotTerm").val();
            else
                BussData.SlotTermID = 0;
            var CountType = 0;
            angular.forEach($scope.DynamicGridCntr, function (value, key) {
                CountType += parseFloat($scope.DynamicGridCntr[key].Qty)

            });
            CntrQtyItems.push(CountType);

            BussData.QtyItems = CntrQtyItems.toString();
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingConfirmInsert',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $timeout(function () {
                   
                    if (result.data.length > 0)
                    {
                        if (result.data[0].Status == "CheckCRO")
                        {
                            $("#overlay").hide();
                            ShowPopup("CRO Partially Released Booking can't confirm");
                            $("#overlay").hide();
                        }
                        if (result.data[0].Status == "CheckCNTRNo")
                        {
                            $("#overlay").hide();
                            ShowPopup("Container Not assigned");
                            $("#overlay").hide();
                        }

                        if (result.data[0].Status == "CheckCROQty")
                        {
                            $("#overlay").hide();
                            ShowPopup("Booking Qty and CRO Qty is not matched");
                            $("#overlay").hide();
                        }

                        if (result.data[0].Status == "Confirm")
                        {
                            $scope.StatusCodeVaues = "CONFIRM";
                            ShowAlertConfirm("Booking Confirm Successfully")
                            $("#overlay").hide();
                        }

                        if (result.data[0].Status == "Error") {
                            ShowAlertConfirm(result.data[0].AlertMessage);
                            $("#overlay").hide();
                        }
                    }
                    else
                    {
                        $("#overlay").hide();
                        ShowPopup("Error Not saved");
                    }

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });


        }
        $scope.BookingCancel = function () {


            var validation = "";

            var RegId = $scope.RegId;
            if (RegId == undefined)
            {
                validation += "<span style='color:red;'>*</span> <span>Generate Booking after Cancelled</span></br>"
            }
            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
            var BussData = {}
            BussData.ID = $scope.RegId;
            BussData.IntStatus = 3;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingCancelled',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $timeout(function () {
                    if (result.data[0].ID != "0") {

                        $scope.StatusCodeVaues = "CANCEL";
                        ShowPopup("Booking Cancelled Successfully");
                    }
                    else {

                        ShowPopup("Error Not saved");
                    }
                    //var url = "/Document/BookingSearch";
                    window.location.href = url;
                    setTimeOut(function () {
                        window.location = "/";
                    }, 3000);
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });
        }

        $scope.SlotOperatorAllvalues = null;


        $("#ddlVesVoy").change(function () {

            var Datavalue = {};
            Datavalue.VesVoyID = $("#ddlVesVoy").val();
            Datavalue.RRID = $scope.HDRRID;
            Datavalue.DirectBKg = $scope.DirectBKg;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingSlotOperator/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.SlotOperatorAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });

        $scope.SlotRefNoAllvalue = null;
        $("#ddlslot").change(function () {

            var Datavalue = {};
            Datavalue.RRID = $scope.HDRRID;
            Datavalue.SlotID = $("#ddlslot").val();
           // Datavalue.VesVoyID = $("#ddlVesVoy").val();
            $http({
                method: 'POST',
               // url: '/api/DocumentApi/BookingSlotRefNoOperator/',
                url: '/api/DocumentApi/RRBookingSlotAmountfill/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                   // $scope.SlotRefNoAllvalue = result.data;

                    if ($scope.txtNoOf20 == 0)
                        $scope.txtslot20 = 0;
                    else
                        $scope.txtslot20 = result.data[0].Cnt20;

                    if ($scope.txtNoOf40 == 0)
                        $scope.txtslot40 = 0;
                    else
                        $scope.txtslot40 = result.data[0].Cnt40;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });

        $("#ddlslotContract").change(function () {

            var Datavalue = {};
            var ArrayCntrValue=[];
            var ArrayCommodityValue = [];
            // Datavalue.ID = $("#ddlslotContract").val();
            Datavalue.SlotRefNo = $("#ddlslotContract option:selected").text();
           
            angular.forEach($scope.DynamicGridCntr, function (value, key) {
                
                ArrayCntrValue.push($scope.DynamicGridCntr[key].CntrTypeID.ID);
                ArrayCommodityValue.push($scope.DynamicGridCntr[key].CommodityType.ID)
            });
            Datavalue.CntrTypeID = ArrayCntrValue.toString();
            Datavalue.CommodityTypeID = ArrayCommodityValue.toString();
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingSlotContractNoOperator/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ddlSlotTerm = { ID: result.data[0].SlotTermID };

                    if ($scope.txtNoOf20 == 0)
                        $scope.txtslot20 = 0;
                    else
                        $scope.txtslot20 = result.data[0].Cnt20;

                    if ($scope.txtNoOf40 == 0)
                        $scope.txtslot40 = 0;
                    else
                        $scope.txtslot40 = result.data[0].Cnt40;
                        
                   // $scope.txtslot20 = result.data[0].Cnt20;
                    //$scope.txtslot40 = result.data[0].Cnt40;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });
        
        $("#ddlPOL").change(function () {

            var Datavalue = {};
            Datavalue.ID = $("#ddlPOL").val();
            $http({
                method: 'POST',
                url: '/api/DocumentApi/ListDepotByPort/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.DepotNameAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });

        $scope.ExistingddlPOL = function (pol) {
            var Datavalue = {};
            Datavalue.ID = pol;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/ListDepotByPort/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.DepotNameAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }

        $scope.FilRateSheetTsPortExsitingMaster = function (RRIDv) {
            var Datavalue = {};

            Datavalue.RRID = RRIDv;
            $http({
                method: 'POST',
                url: '/api/SalesApi/RateSheetTsPortExsisting',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function ()
                {
                    if (result.data.length > 0) {
                        if (result.data[0].PortID != "") {
                            $scope.DynamicGridTsPort.splice(0, 1);
                        }

                        angular.forEach(result.data, function (value, key) {

                            $scope.DynamicGridTsPort.push({
                                'PortID': { ID: result.data[key].PortID },
                              

                            });
                            $scope.TsPortChange(result.data[key].PortID, key);
                        });
                    }
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }


        $scope.ExistingSoltOperator = function (VoyID, RRIDv, DirectBKgv) {


            var Datavalue = {};
            Datavalue.VesVoyID = VoyID;
            Datavalue.RRID = RRIDv;
            Datavalue.DirectBKg = DirectBKgv;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingSlotOperator/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.SlotOperatorAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }

        $scope.ExistingSlotContact = function (SlotID, VoyID) {

            var Datavalue = {};
            Datavalue.SlotID = SlotID;
            Datavalue.VesVoyID = VoyID;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingSlotRefNoOperator/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.SlotRefNoAllvalue = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }


        $scope.FilBkgTsPortExsitingMaster = function (BkgID) {
            var Datavalue = {};

            Datavalue.ID = BkgID;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingTransPortOperator',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function ()
                {
                    if (result.data.length > 0)
                    {
                        if (result.data[0].PortID != "") {
                            $scope.DynamicGridTsPort.splice(0, 1);
                        }

                        angular.forEach(result.data, function (value, key) {

                            $scope.DynamicGridTsPort.push({
                                'PortID': { ID: result.data[key].TsPortID },
                                

                            });
                            $scope.TsPortChange(result.data[key].TsPortID,key, result.data[key].TsAgencyID);
                        });
                    }
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }


        $scope.btnCRODisplayClick = function ()
        {
            $("#overlay").show();
            var Datavalue = {};
            Datavalue.BkgID = $scope.RegId;
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/BookingCntrTypeValues/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $("#overlay").hide();
                    if (result.data[0].Qty == 0) {
                        var url = "/Document/CROFinalView?BkgCROID=" + encodeURIComponent($scope.RegId);
                        window.location.href = url;
                    }
                    else {
                        var url = "/Document/CRO?BkgCROID=" + encodeURIComponent($scope.RegId);
                        //var url = "/Document/CROFinalNew?BkgCROID=" + encodeURIComponent($scope.RegId);
                        window.location.href = url;
                    }

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });




        }
        $scope.btnCntrAllotClick = function () {

            window.location.href = "/Document/ContainerPickup?BkgRegID=" + $scope.RegId + "&BkgConfim=1";
        }

        $("#ddlPOD").change(function () {

            var Datavalue = {};
            Datavalue.PortID = $("#ddlPOD").val();
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortAgencyMaster/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $scope.AgencyMasterAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });

      
        $scope.TranshimentMasterAllvalues = null;
        $("#ddlTSPort").change(function ()
        {

            var Datavalue = {};
            Datavalue.PortID = $("#ddlTSPort").val();
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortAgencyMaster/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $scope.TranshimentMasterAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        });

        $scope.TranshimentAgent = function (PrrtIDv) {

            var Datavalue = {};
            Datavalue.PortID = PrrtIDv;
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortAgencyMaster/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $scope.TranshimentMasterAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }


        $scope.PortAgentDetails = function (PortID)
        {
            var Datavalue = {};
            Datavalue.PortID = PortID;
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortAgencyMaster/',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {
                    $scope.AgencyMasterAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }


        $scope.btnSendEmailAlertDisplay = function () {

            $('#demoModalEmail').modal('show');
            $("#overlay").show();
            var Datavalue = {};
            Datavalue.BkgID = $scope.RegId;
            Datavalue.AgentID = localStorage.getItem("AgencyID");
            Datavalue.EmailTypes = 210;
            $http({
                method: 'POST',
                url: '/api/SendingEmailsApi/SendAutoEmails/',
                data: JSON.stringify(Datavalue),
            }).then(function (result)
            {
                $timeout(function () {
                    if (result.data.length > 0)
                    {
                        $scope.txtTo = result.data[0].EmailIDs;
                       
                        $("#overlay").hide();
                    }
                });
                $("#overlay").hide();
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }


        $scope.btnSendEmailAlert = function () {

            $("#overlay").show();
            var Datavalue = {};
            Datavalue.BkgID = $scope.RegId;
            Datavalue.AgentId = localStorage.getItem("AgencyID");
            Datavalue.To = $scope.txtTo;
            Datavalue.CC = $scope.txtCC;
            Datavalue.BCC = $scope.txtBCC;
            Datavalue.Message = $scope.txtMessage;

            $http({
                method: 'POST',
                url: '/api/SendingEmailsApi/EmailsendingBooking/',
                data: JSON.stringify(Datavalue),
            }).then(function (result)
            {
                $timeout(function () {
                    if (result.data.length > 0) {
                        ShowPopup(result.data[0].AlertMessage);
                        $("#overlay").hide();
                    }
                });
                $("#overlay").hide();
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        }


        function ShowAlert(message) {
            swal.fire({
                title: message,
                text: "",
                icon: 'success',
                showCancelButton: true,
                showConfirmButton: true,
                confirmButtonText: 'Send Email!',
                cancelButtonText: "Back!",
            }).then((result) => {
                if (result.value == true)
                {
                    
                    var Datavalue = {};
                    Datavalue.BkgID = $scope.RegId;
                    Datavalue.AgentId = localStorage.getItem("AgencyID");

                    $http({
                        method: 'POST',
                        url: '/api/SendingEmailsApi/BookingSaveConfirmEmail/',
                        data: JSON.stringify(Datavalue),
                    }).then(function (result) {

                    }, function (result)
                    {
                        if (result.status == 500) {
                            ShowPopup("Sorry no internet connectivity Application Error.");
                        }
                        else if (result.status == 404) {
                            ShowPopup("Sorry no internet connectivity page not found.");
                        }
                        if (result.status > 0) {
                            var errorMsg = result.status + ': ' + result.data;
                            ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                        }
                    }).catch(function (result) {
                        ShowPopup('There has been an error: ' + result);
                    });
                    swal.fire("Email Sent Successfully!", "Booking Details!", "success");
                    

                }
                else {
                    swal.fire("Back!", " !", "warning");

                }
            });
        }

        function ShowAlertConfirm(message) {
            swal.fire({
                title: message,
                text: "",
                icon: 'success',
                showCancelButton: true,
                showConfirmButton: true,
                confirmButtonText: 'Send Email!',
                cancelButtonText: "Back!",
            }).then((result) => {
                if (result.value == true)
                {

                    var Datavalue = {};
                    Datavalue.BkgID = $scope.RegId;
                    Datavalue.AgentID = localStorage.getItem("AgencyID");

                    $http({
                        method: 'POST',
                        url: '/api/SendingEmailsApi/EmailAlertBookingSaveConfirmPdf/',
                        data: JSON.stringify(Datavalue),
                    }).then(function (result)
                    {
                        swal.fire(result.data[0].AlertMessage, "Booking Details!", "success");
                        var url = "/Document/BookingSearch";
                        window.location.href = url;

                    }, function (result) {
                        if (result.status == 500) {
                            ShowPopup("Sorry no internet connectivity Application Error.");
                        }
                        else if (result.status == 404) {
                            ShowPopup("Sorry no internet connectivity page not found.");
                        }
                        if (result.status > 0) {
                            var errorMsg = result.status + ': ' + result.data;
                            ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                        }
                    }).catch(function (result) {
                        ShowPopup('There has been an error: ' + result);
                    });
                   


                }
                else {
                    swal.fire("Back!", " !", "warning");
                    var url = "/Document/BookingSearch";
                    window.location.href = url;

                }
            });
        }


        $scope.BookingCancelRestored = function () {
          

            var validation = "";
            var RegId = $scope.RegId;
            if (RegId == undefined) {
                validation += "<span style='color:red;'>*</span> <span>Generate Booking after Cancelled Restored</span></br>"
            }
            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
            var BussData = {}
            BussData.ID = $scope.RegId;
            BussData.IntStatus = 1;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BookingCancelled',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $timeout(function () {
                    if (result.data[0].ID != "0") {

                        $scope.StatusCodeVaues = "DRAFT";
                        ShowPopup("Booking Cancelled Restored Successfully");
                    }
                    else {

                        ShowPopup("Error Not saved");
                    }
                    var url = "/Document/BookingSearch";
                    //window.location.href = url;
                    setTimeOut(function () {
                        window.location = "/";
                    }, 3000);
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });
        }



        $scope.DeleteRemove = function (DynamicGridCntr, index) {
            if ($scope.DynamicGridCntr.length == 1)
            {
                ShowPopup("If there is only one Container Type delete not Allowed");
                return;
            }
            $scope.DynamicGridCntr.splice(index, 1);

        }

        $("#btnTranship").click(function () {
           
            if ($('#ddlTSPort').val() != "" && $('#ddlTSPort').val() != "?" && $('#ddlTSPort').val() != null) {
                $('#demoModalTranshipment').modal('show');
                if ($scope.RegId != "undefined")
                    $scope.FilRateSheetTsPortExsitingMaster($scope.RegRRId);
                else
                    $scope.FilBkgTsPortExsitingMaster($scope.RegId);
            }

        });



        $scope.TsPortChange = function (gRow, index, selectedterminal) {

            var Datavalue = {};
            if (gRow.PortID && typeof gRow.PortID.ID != undefined)
                Datavalue.PortID = gRow.PortID.ID
            else
                Datavalue.PortID = gRow

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortAgencyMaster/',
                data: JSON.stringify(Datavalue),
                // data: {}
            }).then(function (result) {

                $("#ddlTsPortAgencyValues" + index).html("");
                for (var i = 0; i < result.data.length; i++) {

                    $("#ddlTsPortAgencyValues" + index).append($("<option>").text(result.data[i].AgencyName).val(result.data[i].ID).attr("label", result.data[i].AgencyName))

                }
                if (selectedterminal) {
                    $("#ddlTsPortAgencyValues" + index).val(selectedterminal);

                }

                $timeout(function () {
                    // console.log($scope);


                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }

        $scope.btnBkgCorrection = function ()
        {

            $('#demoModalCorrection').modal('show');
            
        }

        $scope.btnCorrectionSave = function () {

            var validation = "";
            var ddlPortofLoading = $('#ddlPOL').val();
            if (ddlPortofLoading == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Loading</span></br>"
            }

            var ddlPortofDischarge = $('#ddlPOD').val();
            if (ddlPortofDischarge == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Discharge</span></br>"
            }
            $("#overlay").show();
            var Datavalue = {};
            //alert($('#ddlCorPOL').val());
            Datavalue.BkgID = $scope.RegId;
            Datavalue.POLID = $('#ddlCorPOL').val();
            Datavalue.POL = $("#ddlCorPOL option:selected").text();
            Datavalue.PODID = $('#ddlCorPOD').val();
            Datavalue.POD = $("#ddlCorPOD option:selected").text();
            Datavalue.BookingNo = $('#txtCorBookingNo').val();
            $http({
                method: 'POST',
                url: '/api/DocumentApi/Bookingupdate',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function ()
                {
                    if (result.data.length > 0)
                    {
                        $scope.FilBookingExsitingMaster($scope.RegId);
                        ShowPopup(result.data[0].AlertMessage)
                        $('#demoModalCorrection').modal('hide');
                        $("#overlay").hide();
                    }
                });
                $("#overlay").hide();
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }

    });

    function numericvalidation() {
        var key = event.keyCode; if ((key >= 48) && (key <= 58) || (key == 46))
            return true;
        else
            return false;
    }

    function ShowPopup(message) {
        swal(message);
    };


</script>


@*<script type="text/javascript">
    $(function () {
        $("#btnTranship").click(function ()
        {
            alert($('#ddlTSPort').val());
            if ($('#ddlTSPort').val() != "" && $('#ddlTSPort').val() != "?" && $('#ddlTSPort').val() != null)
            {
                $('#demoModalTranshipment').modal('show');

            }
          
        });
       
    });
</script>*@
<div ng-app="MyApp" ng-controller="MyController">

    <div id="overlay" style="display:none;">
        <div class="loadcontainer">
            <div class="spinner"></div>
            <p>Loading Please Wait</p>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 backbtn" style="text-align:right;">
                <a href="/Document/BookingSearch" type="submit" class="btn btn-fill btnback btn-success btn-round btntop">
                    <i class="material-icons">reply</i> Back
                </a>

            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="card-header card-header-primary card-header-text">
                        <div class="row">
                            <div class="col-md-2">
                                <div class="card-text" style="z-index: 10000;">
                                    <h4 class="card-title">Booking</h4>
                                </div>
                            </div>
                            <div class="col-md-10">
                                <marquee id="displayHid" style="color:red;">
                                    THIS BOOKING  IS CREATED VIA  ONLINE CUSTOMER PORTAL
                                </marquee>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row" style="border: 1px solid #ccc; padding-top: 6px;">
                            <div class="col-md-5"></div>
                            <div class="col-md-3 padr0" style="text-align:right;">
                                <h5 style="color:#000000;font-weight: 500; font-size:13px; margin-left:79px; line-height:2.4em; margin-bottom:0;">STATUS<span ng-bind="StatusCodeVaues" style="border:1px solid #e23756; margin-left:10px; padding: 7px 14px; font-weight:bold;color:#e91e63;"></span></h5>
                            </div>
                            <div class="col-md-2 padl0">
                                <div class="row">
                                    <div class="col-md-4 padr0" style="text-align:right; font-size:13px;">DATE</div>
                                    <div class="col-md-8">
                                        <input type="date" id="txtDate" ng-bind="txtDate" autocomplete="off" class="form-control" style="width:111px;" placeholder="Date" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 pull-right">

                                <div class="dropdown">
                                    <a class="btn btn-success btndrop dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        OPTIONS
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                        <a class="dropdown-item" href="#" ng-click="btnCRODisplayClick();" id="btnCRODisplay"><i class="fa fa-user"></i> <span style="padding-left:20px;">CRO</span></a>
                                        <a class="dropdown-item" href="#" id="btnCntrAllot" ng-click="btnCntrAllotClick();"><i class="fa fa-bookmark" style="color: #0585b5;"></i> <span style="padding-left:20px;">Allot Containers</span></a>
                                        <a class="dropdown-item" href="#" id="btnBkgCorrection" ng-click="btnBkgCorrection();"><i class="fa fa-bookmark" style="color: #0585b5;"></i> <span style="padding-left:20px;">Update Correction</span></a>


                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row" style="border:1px solid #ccc; margin-top:15px; padding-right:15px;">
                            <div class="col-md-8" style="padding-top: 15px;">
                                <div class="col-md-12 padlr0">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Booking Number</label>
                                                        <input type="text" readonly autocomplete="off" id="txtBookingNo" ng-model="txtBookingNo" class="form-control">

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12" id="DivRRvisible">
                                                        <label>RR Number</label>
                                                        <input type="text" readonly autocomplete="off" id="txtRRNo" ng-model="txtRRNo" class="form-control">
                                                        <input type="hidden" id="HDRRID" ng-model="HDRRID" class="form-control">
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Valid Till<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span> </label>

                                                        <input type="date" id="txtValidTill" ng-bind="txtValidTill" autocomplete="off" class="form-control" />
                                                    </div>

                                                </div>
                                            </div>
                                        </div>




                                    </div>

                                </div>
                                <div class="col-md-12 padlr0">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label class="lblfont">Liner  Prefix <span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select id="ddlLinePrefix" class="form-control my-select" ng-model="ddlLinePrefix" options="{ allowClear: true }" ng-options="item.GeneralName for item in LinerPrefixAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label class="lblfont">Booking Party <span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select id="ddlBookingParty" class="form-control my-select" ng-model="ddlBookingParty" options="{ allowClear: true }" ng-options="item.CustomerName for item in BookingPartyAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Sales Person<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select class="form-control my-select" id="ddlSalesPerson" ng-model="ddlSalesPerson" ng-options="item.UserName for item in UserNameMasterAllvalues track by item.ID">
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                                <div class="col-md-12 padlr0">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>POO</label>
                                                        <select id="ddlPOO" class="form-control my-select" ng-model="ddlPOO" options="{ allowClear: true }" ng-options="item.CityName for item in CityAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>POL<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select id="ddlPOL" class="form-control my-select" ng-model="ddlPOL" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>POD<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select id="ddlPOD" class="form-control my-select" ng-model="ddlPOD" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>FPOD</label>
                                                        <select id="ddlFPOD" class="form-control my-select" ng-model="ddlFPOD" options="{ allowClear: true }" ng-options="item.CityName for item in CityAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 padlr0">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Transhipment Port</label><span>
                                                            <a href="#" id="btnTranship">Add</a>
                                                        </span>
                                                        <select class="form-control my-select" id="ddlTSPort" ng-model="ddlTSPort" ng-options="item.PortName for item in PortAllvalues track by item.ID">
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Transhipment Agent</label>
                                                        <select class="form-control my-select" id="ddlTranshipmentAgent" ng-model="ddlTranshipmentAgent" ng-options="item.AgencyName for item in TranshimentMasterAllvalues track by item.ID">
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Destination Agent<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                        <select class="form-control my-select" id="ddlDestinationAgent" ng-model="ddlDestinationAgent" ng-options="item.AgencyName for item in AgencyMasterAllvalues track by item.ID">
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Shipment Type</label>
                                                        <select class="form-control my-select" id="ddlShipmentType" ng-model="ddlShipmentType" options="{ allowClear: true }" ng-options="item.GeneralName for item in ShipmentTypeAllvalues track by item.ID">
                                                        </select>
                                                    </div>


                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Service Type</label>
                                                        <select class="form-control my-select" id="ddlServiceType" ng-model="ddlServiceType" ng-options="item.ServiceTypesName for item in ServiceTypesValue track by item.ID">
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Shipper<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span>	</label>
                                                        <select id="ddlShipper" ng-model="ddlShipper" class="form-control my-select" ng-options="item.CustomerName for item in ShipperAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-12 padlr0">
                                    <div class="row">


                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>PortNet Reference</label>
                                                        <input type="text" id="PortNtRef" autocomplete="off" ng-model="PortNtRef" class="form-control" />
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-8">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Pick Up Depot<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span>	</label>
                                                        <select id="ddlPickUpDepot" ng-model="ddlPickUpDepot" class="form-control my-select" ng-options="item.PickUpDepot for item in DepotNameAllvalues track by item.ID"></select>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="row">

                                        <div class="col-md-12 padlr0">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Remarks</label>
                                                        <textarea id="txtRemarks" autocomplete="off" rows="3" ng-model="txtRemarks" class="form-control"></textarea>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>


                                        <div class="col-md-4 padlr0">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12 padr0">
                                                        <label>Prepared By<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span>	</label>
                                                        <select id="ddlPreparedBy" ng-model="ddlPreparedBy" class="form-control my-select" ng-options="item.UserName for item in UserNameMasterAllvalues track by item.ID"></select>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-4" style="border-left:1px solid #ccc; height:auto;padding-top: 15px;">
                                <div class="row">

                                    <div class="col-md-12 padr0">
                                        <div class="material-datatables" style="overflow-y: scroll; height: 150px; border: 1px solid #ccc;">

                                            <table class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                                <thead>
                                                    <tr>
                                                        <th colspan="6">Container & Commodity</th>

                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <tr ng-repeat="gRow in DynamicGridCntr">
                                                        <td>{{$index+1}}</td>

                                                        <td>
                                                            <select style="width:60px;" class="form-control" ng-disabled="IsddlCntrTypes" id="ddlCntrTypes" ng-model="gRow.CntrTypeID" options="{ allowClear: true }" ng-options="item.CntrTypes for item in CntrTypesvalues track by item.ID">
                                                            </select>
                                                        </td>


                                                        <td><input style="width:40px;" type="text" id="txtAmt" autocomplete="off" onkeypress="return numericvalidation();" ng-change="setTotals(DynamicGridCntr)" class="form-control" ng-model="gRow.Qty" /></td>
                                                        <td>
                                                            <select class="form-control" width="100px" id="ddlCommodityType" ng-model="gRow.CommodityType" ng-options="item.GeneralName for item in CommodityValue track by item.ID">
                                                            </select>
                                                        </td>
                                                        <td><input type="hidden" id="HDBID" class="form-control" ng-model="gRow.BID" /></td>

                                                        <td class="td-actions text-right">
                                                            <button type="button" rel="tooltip" ng-if="$last" ng-show="CntrButtonshow" ng-click="CntrTypesRowAdd(DynamicGridCntr)" class="btn btn-primary btn-round" data-original-title="" title="">
                                                                <i class="material-icons">add</i>
                                                            </button>



                                                            <button type="button" rel="tooltip" ng-if="!$last" ng-show="CntrButtonshow" ng-click="Remove(DynamicGridCntr,$index)" class="btn btn-danger btn-round" data-original-title="" title="">
                                                                <i class="material-icons">delete</i>
                                                            </button>

                                                            <button type="button" rel="tooltip" ng-show="CntrButtonDeleteshow" ng-click="DeleteRemove(DynamicGridCntr,$index)" class="btn btn-danger btn-round" data-original-title="" title="">
                                                                <i class="material-icons">delete</i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </tbody>

                                            </table>

                                        </div>
                                    </div>
                                    <div class="col-md-12 padr0">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>No.Of 20</label>
                                                    <input type="text" id="txtNoOf20" ng-model="txtNoOf20" autocomplete="off" onkeypress="return numericvalidation();" class="form-control" placeholder="No.Of 20" />
                                                </div>
                                                <div class="col-md-6">
                                                    <label>No.Of 40</label>
                                                    <input type="text" id="txtNoOf40" ng-model="txtNoOf40" autocomplete="off" onkeypress="return numericvalidation();" class="form-control" placeholder="No.Of 40" />
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-md-12 rightbox">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-12 padr0">
                                                    <label>Vessel & Voyage<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span></label>
                                                    <select id="ddlVesVoy" ng-model="ddlVesVoy" class="form-control my-select" ng-options="item.VesVoy for item in VesselNameAllvalues track by item.ID"></select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12 rightbox">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-12 padr0">
                                                    <label>Slot Operator<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span>	</label>
                                                    <select id="ddlslot" ng-model="ddlslot" class="form-control my-select" ng-options="item.VesOperator for item in SlotOperatorAllvalues track by item.ID"></select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    @*<div class="col-md-12 rightbox">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12 padr0">
                                                        <label>Slot Contract#<span style="color: red; padding-left: 5px; font-size: 16px; margin-top:10px;">*</span>	</label>
                                                        <select id="ddlslotContract" ng-model="ddlslotContract" class="form-control my-select" ng-options="item.SlotRefNo for item in SlotRefNoAllvalue track by item.ID"></select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>*@

                                    <div class="col-md-12 slotbox">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-md-4 padr0">
                                                    <label>Slot -20</label>
                                                    <input id="txtslot20" ng-model="txtslot20" ng-disabled="IsSlotdisable" autocomplete="off" onkeypress="return numericvalidation();" class="form-control" />
                                                </div>
                                                <div class="col-md-4 padr0">
                                                    <label>Slot-40</label>
                                                    <input id="txtslot40" ng-model="txtslot40" ng-disabled="IsSlotdisable" disabled autocomplete="off" onkeypress="return numericvalidation();" class="form-control" />
                                                </div>
                                                <div class="col-md-4 padr0">
                                                    <label>Slot-Terms</label>
                                                    <select class="form-control" id="ddlSlotTerm" ng-disabled="IsSlotdisable" ng-model="ddlSlotTerm" ng-options="item.SlotTerm for item in SlotTermsValue track by item.ID">
                                                    </select>
                                                    <input id="HDSlotPrincible" type="hidden" ng-model="HDSlotPrincible" />
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>

                            </div>




                        </div>

                    </div>


                    <div class="row">

                        <div class="col-md-12" style="text-align:right;">
                            <input type="hidden" id="RegId" ng-model="RegId" />
                            <input type="hidden" id="RegRRId" ng-model="RegRRId" />
                            <input type="hidden" id="DirectBKg" ng-model="DirectBKg" />
                            <button type="submit" id="btnSave" ng-click="SaveRecord(DynamicGridCntr,DynamicGridTsPort);" class="btn btn-success">
                                <i class="material-icons">save</i>
                                Save
                            </button>
                            <button type="submit" id="btnCancel" ng-click="BookingCancel();" class="btn btn-danger">
                                <i class="material-icons">cancel</i>
                                Cancel
                            </button>
                            <button type="submit" id="btnConfirm" ng-click="BookingConfirm();" class="btn btn-primary">
                                <i class="material-icons">done</i>
                                Confirm
                            </button>
                            <button type="submit" id="btnRestore" ng-click="BookingCancelRestored();" class="btn btn-info">
                                <i class="material-icons">cancel</i>
                                Restore Cancel
                            </button>
                            <button type="submit" id="btnPdf" ng-click="btnPrint();" class="btn btn-warning">
                                <i class="material-icons">print</i>
                                Print
                            </button>
                            <button type="submit" ng-click="btnSendEmailAlertDisplay();" id="btnEmail" class="btn btn-default">
                                <i class="material-icons">email</i>
                                Send Email
                            </button>
                        </div>
                    </div>

                    <div class="modal fade" id="demoModalTranshipment" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog" style="width:800px;">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-12" style="text-align:center;">
                                            <div class="card-header card-header-primary card-header-text">
                                                <div class="card-text">
                                                    <h1 class="card-title">Additional T/S Port</h1>
                                                </div>
                                            </div>

                                            <div class="col-md-12" style="margin-top:20px;">
                                                <div class="material-datatables">

                                                    <table class="table table-striped table-no-bordered table-hover" cellspacing="0" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th>SNo</th>

                                                                <th>T/S Port</th>
                                                                <th>T/S Agent</th>


                                                                <th class="disabled-sorting text-right actwid">Actions</th>
                                                            </tr>
                                                        </thead>

                                                        <tbody>
                                                            <tr ng-repeat="gRow in DynamicGridTsPort">
                                                                <td>{{$index+1}}</td>

                                                                <td>
                                                                    <select class="form-control" id="ddlTSPortValues" ng-model="gRow.PortID" ng-change="TsPortChange(gRow,$index);" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select>
                                                                </td>
                                                                <td>
                                                                    <select class="form-control" id="ddlTsPortAgencyValues{{$index}}" ng-change="TsPortOnload(iRow,$index);" ng-model="gRow.TsAgencyID"></select>
                                                                </td>

                                                                <td class="td-actions text-right actwid">
                                                                    <button type="button" rel="tooltip" ng-if="$last" ng-click="AdditionTSPortAdd(gRow)" class="btn btn-primary btn-round" data-original-title="" title="">
                                                                        <i class="material-icons">add</i>
                                                                    </button>
                                                                    <button type="button" rel="tooltip" ng-if="!$last" ng-click="AdditionTSPortAddRemove(DynamicGridFreight,$index)" class="btn btn-danger btn-round" data-original-title="" title="">
                                                                        <i class="material-icons">delete</i>
                                                                    </button>
                                                                </td>
                                                            </tr>

                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>




                            </div>
                        </div>
                    </div>


                </div>
            </div>

        </div>


    </div>

    <div class="modal fade" id="demoModalEmail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width:650px;">
            <div class="modal-content">
                <div class="modal-header" style="padding: 5px 24px 0;background-color: #4f2576; ">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <div class="row">
                        <div class="col-md-12" style="text-align:center;">
                            <h1 class="card-title" style="width: 600px; font-size: 17px; color: #fff; padding: 10px; text-align: center; font-weight:bold;">Email Send</h1>
                        </div>
                    </div>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-2">To:</div>

                        <div class="col-md-10 padl0">
                            <div class="form-group">
                                <textarea id="txtTo" ng-model="txtTo" class="form-control" rows="2" style="margin-left:-31px; width: 537px;"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">Cc:</div>
                        <div class="col-md-10 padl0">
                            <div class="form-group">
                                <textarea id="txtCC" ng-model="txtCC" class="form-control" rows="2" style="margin-left:-31px; width: 537px;"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">Bcc:</div>
                        <div class="col-md-10 padl0">
                            <div class="form-group">
                                <textarea id="txtBCC" ng-model="txtBCC" class="form-control" rows="2" style="margin-left:-31px; width: 537px;"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">Message:</div>
                        <div class="col-md-10 padl0">
                            <div class="form-group">
                                <textarea id="txtMessage" ng-model="txtMessage" class="form-control" rows="5" style="margin-left:-31px; width: 537px;"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12" style="text-align: right;">
                            <button type="submit" id="btnEmail" ng-click="btnSendEmailAlert();" class="btn btn-primary" style="box-shadow:none!important;">
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="modal fade" id="demoModalCorrection"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width:650px;">
            <div class="modal-content">
                <div class="modal-header" style="padding: 5px 24px 0;background-color: #4f2576; ">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <div class="row">
                        <div class="col-md-12" style="text-align:center;">
                            <h1 class="card-title" style="width: 600px; font-size: 17px; color:red; padding: 10px; text-align: center; font-weight:bold;">Update Correction</h1>
                        </div>
                    </div>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-4">Booking No</div>

                        <div class="col-md-8 padl0">
                            <div class="form-group">
                                <input type="text" autocomplete="off" id="txtCorBookingNo" ng-model="txtBookingNo" class="form-control" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">POL</div>
                        <div class="col-md-8 padl0">
                            <div class="form-group">

                                <select id="ddlCorPOL" class="form-control my-select"
                                        ng-model="ddlCorPOL" options="{ allowClear: true }" 
                                        ng-options="item.PortName for item in PortAllvalues track by item.ID">

                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">POD</div>
                        <div class="col-md-8 padl0">
                            <div class="form-group">
                                <select id="ddlCorPOD" class="form-control my-select" ng-model="ddlCorPOD" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select>
                            </div>
                        </div>
                    </div>
 
                    <div class="row">
                        <div class="col-md-12" style="text-align: right;">
                            <button type="submit" id="btnEmail" ng-click="btnCorrectionSave();" class="btn btn-primary" style="box-shadow:none!important;">
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(document).ready(function () {
        $('.datepicker').datetimepicker({
            format: 'DD/MM/YYYY',

        });
    });
</script>