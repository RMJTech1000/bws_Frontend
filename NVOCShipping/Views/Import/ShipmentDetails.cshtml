@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.min.js"></script>
<script type="text/javascript">

    LayoutApp.controller('MyController', function ($scope, $http, $timeout) {

        $(window).load(function () {
            $('#overlay').show();
        });
       
        $(document).ready(function () {
            $('.my-select').select2({
                placeholder: "--Select--",
                allowClear: true,
                width: '100%'
            });
        });

        $scope.ImpIHCValues = [
            { 'name': '--select--', 'ID': 0 },
            { 'name': 'Yes', 'ID': 1 },
            { 'name': 'No', 'ID': 2 },
         
        ];

        $scope.BindModeValues = [
            { 'name': 'Combined', 'ID': 1 },
            { 'name': 'Detention', 'ID': 2 },
            { 'name': 'Demmurage', 'ID': 3 }
        ];
        $scope.DynamicGridMode = [{ Mode: "", ImpFreeDays: "" }];


        $scope.HDParentBLID = "0";
        $scope.IsVisible = true;
        $scope.IsBLNodisablevalue = false;
        $scope.IsVisibleCntr = true;
        $scope.Isdisablevalue = false;
        $scope.IsdisablevaluePort = false;
        $scope.IsdisablevalueHid = false;
        $scope.IsVisibleControl = true;
        $scope.DisplayBindMBLNo = false;
        $scope.FreeDaydisable = true;
        //$scope.btnContainerAssign = true;


        $scope.FilBookingExsitingMaster = function (ImpReg) {
          
            var Datavalue = {};
            Datavalue.ID = ImpReg;

            $http({
                method: 'POST',
                url: '/api/ImportApi/BkgExistingDtls',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {
                $timeout(function () {
                    if (result.data.length > 0)
                    {
                        $scope.RegId = result.data[0].ID;
                        $scope.txtRRNO = result.data[0].RRNo;
                        $scope.txtBookingNo = result.data[0].BookingNo;
                        $scope.ContainerAssignBLNO = result.data[0].BookingNo;
                        $scope.ddlBookingParty = { ID: result.data[0].BkgPartyID };
                        $scope.ddlPOO = { ID: result.data[0].POOID };
                        $scope.ddlPOL = { ID: result.data[0].POLID };
                        $scope.ddlPOD = { ID: result.data[0].PODID };
                        $scope.ddlFPOD = { ID: result.data[0].FPODID };
                        $scope.ddlCommodityType = { ID: result.data[0].CommodityTypeID };
                        $scope.ddlSurrender = { ID: result.data[0].SurrenderID };
                        $scope.ddlShipper = { ID: result.data[0].Shipper };
                        $scope.ddlConsignee = { ID: result.data[0].Consignee };
                        $scope.ddlNotify = { ID: result.data[0].Notify };
                        $scope.ddlDestinationAgent = { ID: result.data[0].DestinationAgentID };
                        $scope.txtFreeDays = result.data[0].FreeDays;
                        $scope.HDDirectImport = result.data[0].BLDirectImport;
                        //$scope.txtHBLNo = result.data[0].HBLNo;
                        //document.getElementById('txtHBLDate').value = result.data[0].HBLDate;
                        $scope.ddlDeliveryType = { ID: result.data[0].DeliveryType };
                        $scope.ddlCustomerCFS = { ID: result.data[0].CFS };
                        $scope.ddlImpIHC = { ID: result.data[0].ImportIHC };
                        $scope.ddlNomCFSType = { ID: result.data[0].NominationCFS };
                        $scope.ddlDestinationAgent = { ID: result.data[0].DestinationAgentID };
                        $scope.txtFreeDays = result.data[0].Freedays;
                        $scope.ddlBLType = { ID: result.data[0].BLType };
                        $scope.HDParentBLID = result.data[0].ParentBLID;
                        $scope.BindMBLNo = result.data[0].MBLNumber;
                        $scope.BLVesVoyID = result.data[0].BLVesVoyID;
                        $scope.BLVesVoy = result.data[0].BLVesVoy;
                        $scope.txtImpMarks = result.data[0].ImpMarks;
                        $scope.txtCargoDesc = result.data[0].ImpDesc;
                        $scope.ddlPrincipal = { ID: result.data[0].PrincipalID };


                        $scope.FilRateSheetModeExsitingMaster(result.data[0].RRID, result.data[0].ID);
                        if (result.data[0].BLDirect == "1")
                        {
                           
                            $scope.btnContainerAssign = false;
                            $scope.IsOnLinedisplay = "ON LINE";
                            $scope.ddlPrincipal = { ID: 6465 };
                            $scope.ddlPrincipaldisplay = true;

                           
                        }
                        else
                        {

                            if (result.data[0].BLType == "40")
                                $scope.btnContainerAssign = true;

                            $scope.IsOnLinedisplay = "OFF LINE";
                            $scope.IsdisablevalueHid = false;

                           
                        }

                        //$scope.IsVisible = true;
                        //$scope.Isdisablevalue = false;
                        //if (result.data[0].BLDirectImport == 1) {
                           
                        //}
                        if (result.data[0].BLType == "42")
                            $scope.DisplayBindMBLNo = true;


                        $scope.Isdisablevalue = true;
                        $scope.IsdisablevaluePort = true;
                        //$scope.IsdisablevalueHid = true;
                        $scope.IsVisible = false;
                        $scope.IsVisibleCntr = false;
                        $scope.IsBLNodisablevalue = true;
                       
                        
                    }

                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }

        $scope.FilRateSheetModeExsitingMaster = function (RRIDv, BLIDv) {
            var Datavalue = {};
            Datavalue.RRID = RRIDv;
            Datavalue.BLID = BLIDv;
            $http({
                method: 'POST',
                url: '/api/ImportApi/BkgExistingModeDtls',
                data: JSON.stringify(Datavalue),
            }).then(function (result) {
                $timeout(function () {

                    if (result.data[0].Mode != "") {
                        $scope.DynamicGridMode.splice(0, 1);
                    }

                    angular.forEach(result.data, function (value, key) {

                        $scope.DynamicGridMode.push({
                            'Mode': { ID: result.data[key].Mode },
                            'ImpFreeDays': result.data[key].ImpFreeDays

                        });

                    });
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }


        $scope.FilBOLVesselVoyageExistingDetails = function (BkgID, BLID) {
         
            var Datavalue = {};
            Datavalue.BkgID = BkgID;
            
            $http({
                method: 'POST',
                url: "/api/ImportApi/ImpVesVoyDtls",
                data: JSON.stringify(Datavalue),
            }).then(function (result) {

                if (result.data[0].VoyageTypes != "") {
                    $scope.DynamicGridVesselVoyage.splice(0, 1);
                }
               
                angular.forEach(result.data, function (value, key) {
                    $scope.DynamicGridVesselVoyage.push({
                        'VoyageTypes': { ID: result.data[key].VoyTypesV },
                        'LegInformation': { ID: result.data[key].LegV },
                        'VesVoy': { ID: result.data[key].VesVoy },
                        'LoadPort': { ID: result.data[key].LoadPortv },
                        'NextPort': { ID: result.data[key].NextPortv },
                        'ETA': result.data[key].ETA,
                        'ETD': result.data[key].ETD,
                        'VID': result.data[key].VID

                    });

                });
               

            });
        };

        $scope.PortAllvalues = null;
        $scope.fillPortsValues = function () {
          
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/PortValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.PortAllvalues = result.data;
                

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillPortsValues();


        $scope.CityMasterAllvalues = null;
        $scope.fillCityMasterValues = function () {

            $http({
                method: 'POST',
                url: '/api/Home/cityBind/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CityMasterAllvalues = result.data;


                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCityMasterValues();


        $scope.ShipmentTypeAllvalues = null;
        $scope.fillShipmentTypeValues = function () {
           
            var Datavalue = {};
            Datavalue.ID = "1"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipmentTypeAllvalues = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipmentTypeValues();


        $scope.AgencyMasterAllvalues = null;
        $scope.fillAgencyMasterValues = function () {
          
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/AgencyMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.AgencyMasterAllvalues = result.data;
                    

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillAgencyMasterValues();

        $scope.CommodityValue = null;
        $scope.fillCommodityValues = function () {

           
            var Datavalue = {};
            Datavalue.ID = "2"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)

            }).then(function (result) {
                $timeout(function () {
                    $scope.CommodityValue = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCommodityValues();

        $scope.ServiceTypesValue = null;
        $scope.fillServiceTypesValues = function () {
           
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ServiceTypesValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.ServiceTypesValue = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillServiceTypesValues();

        $scope.ShipmentTypeAllvalues = null;
        $scope.fillShipmentTypeValues = function () {
            
            var Datavalue = {};
            Datavalue.ID = "1"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipmentTypeAllvalues = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipmentTypeValues();

        $scope.UserNameMasterAllvalues = null;
        $scope.fillUserMasterValues = function () {
            
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/UserMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.UserNameMasterAllvalues = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillUserMasterValues();

        $scope.BookingPartyAllvalues = null;
        $scope.fillBookingPartyValues = function () {
            
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.BookingPartyAllvalues = result.data;
                    $('#overlay').hide();

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBookingPartyValues();

        $scope.CarrierAllvalues = null;
        $scope.fillCarrierValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CarrierAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCarrierValues();

        $scope.ShipperAllvalues = null;
        $scope.fillShipperValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.ShipperAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillShipperValues();

        $scope.DepotNameAllvalues = null;
        $scope.fillDepotValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/DepotMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.DepotNameAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillDepotValues();


        $scope.VesselNameAllvalues = null;
        $scope.fillVesselNameValues = function () {

            var BussData = {}
            BussData.Status = 0;
            BussData.AgencyID = localStorage.getItem("AgencyID");
            BussData.ID = $scope.HdID;
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/VesVoyMasterAgencywise/',
                //url: '/api/CommonAccessApi/ImportBLVesVoy/',
                data: JSON.stringify(BussData),
            }).then(function (result) {
                $timeout(function () {
                    $scope.VesselNameAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillVesselNameValues();

        $scope.CntrTypesvalues = null;
        $scope.fillCntrTypeValues = function () {
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CntrTypeValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrTypesvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCntrTypeValues();

        $scope.BookingNoValues = null;
        $scope.fillBookingNoValues = function () {
           
            $http({
                method: 'POST',
                url: '/api/ImportApi/BkgNoDropDown/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.BookingNoValues = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBookingNoValues();

        $scope.ModuleAllvalues = null;
        $scope.fillModuleValues = function () {
            var Datavalue = {};
            Datavalue.ID = "30"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.ModuleAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillModuleValues();

        $scope.SurrenderAllvalues = null;
        $scope.fillSurrenderValues = function () {
           
            var Datavalue = {};
            Datavalue.ID = "16"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.SurrenderAllvalues = result.data;
                    
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillSurrenderValues();


        $scope.CustomerCFSMaster = null;
        $scope.fillCustomerCFSMaster = function () {

            $http({
                method: 'POST',
                url: '/api/ImportApi/CustomerCFSMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CustomerCFSMaster = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCustomerCFSMaster();





        $scope.PrincipalAllvalues = null;
        $scope.fillPrincipalValues = function () {
            var BussData = {}
            BussData.BussTypes = 16
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CustomerMasterParameterPass/',
                data: JSON.stringify(BussData),
            }).then(function (result) {
                $timeout(function () {
                    $scope.PrincipalAllvalues = result.data;
                    $scope.ddlDestinationAgent = { ID: localStorage.getItem("AgencyID") };

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillPrincipalValues();

        $scope.NominationCFSTypes = null;
        $scope.fillNominationCFSTypes = function () {
          
            $http({
                method: 'POST',
                url: '/api/ImportApi/BindNominationCFSTypes/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.NominationCFSTypes = result.data;
                  
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillNominationCFSTypes();

        $scope.voyageTypes = null;
        $scope.fillVoygaeTypes = function () {
            var Datavalue = {};
            Datavalue.ID = "27"; //GeneralMaster Table seqNo 
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.voyageTypes = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillVoygaeTypes();

        $scope.LegInformation = null;
        $scope.fillLegInformation = function () {
         
            var Datavalue = {};
            Datavalue.ID = "26"; //GeneralMaster Table seqNo 
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.LegInformation = result.data;
                   
                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillLegInformation();


        $scope.BlTypesAllvalues = null;
        $scope.fillBLTypesValues = function () {
            var Datavalue = {};
            Datavalue.ID = "17"; //GeneralMaster Table seqNo
            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/ModuleValues/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    $scope.BlTypesAllvalues = result.data;
                    $scope.ddlBLType = { ID: result.data[0].ID };



                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillBLTypesValues();


        $scope.DynamicGridVesselVoyage = [{ VID: "", VoyageTypes: "", LegInformation: "", VesVoy: "", LoadPort: "", NextPort: "", ETA: "", ETD: "" }]
        $scope.VoyageRowAdd = function (val, i) {
            if (val[i].VesVoy.ID == "") {
                swal("Please enter VeslVoyage");
                return;
            }
            $scope.DynamicGridVesselVoyage.push({
                'VID': "",
                'VoyageTypes': "",
                'LegInformation': "",
                'VesVoy': "",
                'LoadPort': "",
                'NextPort': "",
                'ETA': "",
                'ETD': ""
            });
        }

        $scope.SelectVesselVoyage = function (val) {
           
            var Datavalue = {};
            Datavalue.VesVoyID = val.VesVoy.ID;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BOLVesselVoyage/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {

                    val.LoadPort = { ID: result.data[0].CurPortID };
                    val.NextPort = { ID: result.data[0].NextPortID };
                    val.ETA = result.data[0].ETA;
                    val.ETD = result.data[0].ETD;
                   
                    //val.Size = result.data[0].Size;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }


        $scope.DynamicGridContainer = [{ BCNID: "", ContainerNo: "", Size: "", ISOCode: "", SealNo: "", NoOfPkg: "", PakgType: "", GrsWt: "", NtWt: "", VGM: "", CBM: "" }]
        $scope.ContainerRowAdd = function (val, i) {
            if (val[i].ContainerNo.ID == "") {
                swal("Please enter ContainerNo");
                return;
            }

            $scope.DynamicGridContainer.push({
                'BCNID': "",
                'ContainerNo': "",
                'Size': "",
                'ISOCode': "",
                'SealNo': "",
                'NoOfPkg': "",
                'PakgType': "",
                'GrsWt': "",
                'NtWt': "",
                'VGM': "",
                'CBM': ""
            });
        }

        $scope.CntrNoValues = null;
        $scope.fileCntrNovalues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CntrNoValues/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CntrNoValues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fileCntrNovalues();

        $scope.CargoMasterAllvalues = null;
        $scope.fillCargoMasterValues = function () {

            $http({
                method: 'POST',
                url: '/api/CommonAccessApi/CargoTypesMaster/',
                data: {}
            }).then(function (result) {
                $timeout(function () {
                    $scope.CargoMasterAllvalues = result.data;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });
        };
        $scope.fillCargoMasterValues();

        $scope.SelectContainer = function (val) {

            var Datavalue = {};
            Datavalue.CntrID = val.ContainerNo.ID;
            $http({
                method: 'POST',
                url: '/api/DocumentApi/BOLCntrNoSelectViewRecord/',
                data: JSON.stringify(Datavalue)
            }).then(function (result) {
                $timeout(function () {
                    val.ISOCode = result.data[0].ISOCode;
                    val.Size = result.data[0].Size;

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }

        $scope.RecordSave = function (datavX, datav,GridMode) {

            var validation = "";


            //var ddlPartyTypes = $('#ddlDeliveryType').val();
            //if (ddlPartyTypes == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Delivery Type</span></br>"
            //}

            //var ddlImpIHC = $('#ddlImpIHC').val();
            //if (ddlImpIHC == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Import THC</span></br>"
            //}

            //var ddlNomCFSType = $('#ddlNomCFSType').val();
            //if (ddlNomCFSType == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Nomination CSF</span></br>"
            //}

            var ddlCustomerCFS = $('#ddlCustomerCFS').val();
            if (ddlCustomerCFS.length == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Enter CFS</span></br>"
            }
            var txtBookingNo = $('#txtBookingNo').val();
            if (txtBookingNo.length == 0) {
                validation += "<span style='color:red;'>*</span> <span>Please Enter Boooking No</span></br>"
            }

            var ddlbookingParty = $('#ddlBookingParty').val();
            if (ddlbookingParty == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Booking Party</span></br>"
            }


            var ddlSurrender = $('#ddlSurrender').val();
            if (ddlSurrender == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Surrender Party</span></br>"
            }
            //var ddlPOO = $('#ddlPOO').val();
            //if (ddlPOO == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Port of POO</span></br>"
            //}

            //var ddlFPOD = $('#ddlFPOD').val();
            //if (ddlFPOD == "?") {
            //    validation += "<span style='color:red;'>*</span> <span>Please Select Port of FPOD</span></br>"
            //}


            var ddlPortofLoading = $('#ddlPOL').val();
            if (ddlPortofLoading == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Loading</span></br>"
            }

            var ddlPortofDischarge = $('#ddlPOD').val();
            if (ddlPortofDischarge == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Port of Discharge</span></br>"
            }
            var ddlShipper = $('#ddlShipper').val();
            if (ddlShipper == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Shipper</span></br>"
            }

            var ddlConsignee = $('#ddlConsignee').val();
            if (ddlConsignee == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Consignee</span></br>"
            }

            var ddlNotify = $('#ddlNotify').val();
            if (ddlNotify == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Notify</span></br>"
            }

            var ddlDestinationAgent = $('#ddlDestinationAgent').val();
            if (ddlDestinationAgent == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select DestinationAgent</span></br>"
            }

            var ddlCommodityType = $('#ddlCommodityType').val();
            if (ddlCommodityType == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select CommodityType</span></br>"
            }

            var ddlPrincipal = $('#ddlPrincipal').val();
            if (ddlPrincipal == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please Select Principal</span></br>"
            }

            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
            $('#overlay').show();


            var BussData = {}
            var Items = [];
            var Itemsv = [];
            var ItemsVX = [];
            var ModeItems = [];
            var id = $scope.RegId;
            if (typeof $scope.RegId == "undefined")
                BussData.ID = 0;
            else
                BussData.ID = $scope.RegId;

            if (typeof $scope.HDBkgID == "undefined")
                BussData.BkgID = 0;
            else
                BussData.BkgID = $scope.HDBkgID;

            BussData.HBLNo = "0";
            BussData.HBLDate = "0";

            BussData.BLTypes = $('#ddlBLType').val();
            BussData.MotherBL = $("#ddlBLType option:selected").text();

            if ($("#ddlDeliveryType").val() != "?")
                BussData.DeliveryType = $("#ddlDeliveryType").val();
            else
                BussData.DeliveryType = 0;

            if ($("#ddlCustomerCFS").val() != "?")
                BussData.CFS = $("#ddlCustomerCFS").val();
            else
                BussData.CFS = 0;

            if ($("#ddlImpIHC").val() != "?")
                BussData.ImportIHC = $("#ddlImpIHC").val();
            else
                BussData.ImportIHC = 0;

           
            BussData.LineNumber = "";

            if ($("#ddlNomCFSType").val() != "?")
                BussData.NominationCFS = $("#ddlNomCFSType").val();
            else
                BussData.NominationCFS = 0;
            


            BussData.SurrenderID = $("#ddlSurrender").val();
            BussData.Freedays = $scope.txtFreeDays;
          
            BussData.ParentBLID = $scope.HDParentBLID;

            BussData.BookingNo = $scope.txtBookingNo;
            BussData.BkgPartyID = $("#ddlBookingParty").val();
            BussData.BkgParty = $("#ddlBookingParty option:selected").text();
            if ($("#ddlPOO").val() != "?")
                BussData.POOID = $("#ddlPOO").val();
            else
                BussData.POOID = 0;

            BussData.POO = $("#ddlPOO option:selected").text();
            BussData.POLID = $("#ddlPOL").val();
            BussData.POL = $("#ddlPOL option:selected").text();
            BussData.PODID = $("#ddlPOD").val();
            BussData.POD = $("#ddlPOD option:selected").text();

            if ($("#ddlFPOD").val() != "?")
                BussData.FPODID = $("#ddlFPOD").val();
            else
                BussData.FPODID = 0;

            BussData.FPOD = $("#ddlFPOD option:selected").text();
            BussData.CommodityTypeID = $("#ddlCommodityType").val();
            BussData.CommodityType = $("#ddlCommodityType option:selected").text();
            BussData.ShipperID = $("#ddlShipper").val();
            BussData.Shipper = $("#ddlShipper option:selected").text();
            BussData.ConsigneeID = $("#ddlConsignee").val();
            BussData.Consignee = $("#ddlConsignee option:selected").text();
            BussData.NotifyID = $("#ddlNotify").val();
            BussData.Notify = $("#ddlNotify option:selected").text();
            BussData.DestinationAgentID = $("#ddlDestinationAgent").val();
            BussData.DestinationAgent = $("#ddlDestinationAgent option:selected").text();
            BussData.UserID = localStorage.getItem("UserID");
            BussData.AgentId = localStorage.getItem("AgencyID");
            BussData.SessionFinYear = "2021";
            BussData.AgentCode = localStorage.getItem("DocumentSuffix");
            if ($("#ddlVesVoy").val() != "?")
                BussData.VesVoyID = $("#ddlVesVoy").val();
            else
                BussData.VesVoyID = 0;
            BussData.VesVoy = $("#ddlVesVoy option:selected").text();
            BussData.DirectImport = $scope.HDDirectImport;
            BussData.BLVesVoyID = $scope.BLVesVoyID;
            BussData.BLVesVoy = $scope.BLVesVoy;
            BussData.PrincipalID = $("#ddlPrincipal").val();
            BussData.ImpMarks = $("#txtImpMarks").val();
            BussData.ImpDesc = $("#txtCargoDesc").val();

            var NetwetS = 0;
            var VGMS = 0;
            var CBMS = 0;
            var CntrID = 0;
            var CntrNo = 0;
            var Size = 0;
            var ISOCode = 0;
          
            angular.forEach(datav, function (value, key) {

                if (typeof datav[key].ContainerNo.ID != "undefined")
                {
                  
                    if (datav[key].NtWt == "")
                        NetwetS = 0;
                    else
                        NetwetS = datav[key].NtWt;

                    if (datav[key].VGM == "")
                        VGMS = 0;
                    else
                        VGMS = datav[key].VGM;

                    if (datav[key].CBM == "")
                        CBMS = 0;
                    else
                        CBMS = datav[key].CBM;

                    if (datav[key].ContainerNo.CntrNo == "")
                        CntrNo = 0;
                    else
                        CntrNo = datav[key].ContainerNo.CntrNo;

                    if (datav[key].ContainerNo.ID == "")
                        CntrID = 0;
                    else
                        CntrID = datav[key].ContainerNo.ID;

                    if (datav[key].Size == "")
                        Size = 0;
                    else
                        Size = datav[key].Size;

                    if (datav[key].ISOCode == "")
                        ISOCode = 0;
                    else
                        ISOCode = datav[key].ISOCode;


                    Itemsv.push('Insert:' + datav[key].BCNID, CntrNo, CntrID, Size, ISOCode,
                        datav[key].SealNo, datav[key].NoOfPkg, datav[key].PakgType.ID, datav[key].PakgType.CargoName, datav[key].GrsWt,
                        NetwetS, VGMS, CBMS);
                }
            });
            console.log(Itemsv);
            BussData.ItemsCntr = Itemsv.toString();


            angular.forEach(datavX, function (value, key) {

                if (typeof datavX[key].LegInformation.ID != "undefined") {
                    ItemsVX.push('Insert:' + datavX[key].VID, datavX[key].VoyageTypes.ID, datavX[key].LegInformation.ID, datavX[key].VesVoy.ID, datavX[key].LoadPort.ID, datavX[key].NextPort.ID, datavX[key].ETA, datavX[key].ETD);
                }
            });
            BussData.ItemsVS = ItemsVX.toString();

            angular.forEach(GridMode, function (value, key) {
                ModeItems.push('Insert:' + GridMode[key].Mode.ID, GridMode[key].ImpFreeDays,);
            });
            BussData.ModeItems = ModeItems.toString();

            $http({
                method: 'POST',
                url: "/api/ImportApi/InsertImpBooking/",
                data: JSON.stringify(BussData),
            }).then(function (result) {
                if (result.data.length > 0)
                {
                  //  $scope.RegId = result.data[0].ID;
                    // $scope.HDBkgID = result.data[0].BkgID;
                    ShowPopup(result.data[0].RecordStatus);

                    var url = "/Import/ImportView";
                    //window.location.href = url;
                    setTimeout(window.location.href = url, 3000)
                }

                $('#overlay').hide();

            });
        }

        $(document).ready(function () {

            var queryString = new Array();
            if (window.location.search.split('?').length > 1) {
                var params = window.location.search.split('?')[1].split('&');
                for (var i = 0; i < params.length; i++) {
                    var key = params[i].split('=')[0];
                    var value = decodeURIComponent(params[i].split('=')[1]);
                    queryString[key] = value;
                }
            }
            if (queryString["ImpReg"] != null)
            {
                $scope.RegId = queryString["ImpReg"].toString();
                $scope.HDBkgID = queryString["BkgID"].toString();
                $scope.FilBookingExsitingMaster(queryString["ImpReg"].toString());
                $scope.FilBOLVesselVoyageExistingDetails(queryString["BkgID"].toString());
                $scope.FilBOLCntrExistingDetails(queryString["BkgID"].toString(), queryString["ImpReg"].toString());
                // $scope.FillImpBooking(queryString["ImpReg"].toString());

            }
            else {
                alert(2)
                $scope.btnContainerAssign = true;
            }


            if (queryString["New"] == "New")
            {
                alert(3)
                $scope.FreeDaydisable = false;
                $scope.IsOnLinedisplay = "OFF LINE";

            }
        });

        $scope.FilBOLCntrExistingDetails = function (HDBkgID, BLIDv) {
            $("#overlay").show();
            var Datavalue = {};
            Datavalue.BkgID = HDBkgID;
            Datavalue.BLID = BLIDv;


            $http({
                method: 'POST',
                url: '/api/ImportApi/BOLCntrImportViewRecord',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {

                $timeout(function () {
                    if (result.data.length > 0) {
                        if (result.data[0].CntrType != "") {
                            $scope.DynamicGridContainer.splice(0, 1);
                        }

                        angular.forEach(result.data, function (value, key) {
                            $scope.DynamicGridContainer.push({
                                'BCNID': result.data[key].BCNID,
                                'ContainerNo': { ID: result.data[key].CntrID },
                                'Size': result.data[key].Size,
                                'ISOCode': result.data[key].ISOCode,
                                'SealNo': result.data[key].SealNo,
                                'NoOfPkg': result.data[key].NoOfPkg,
                                'PakgType': { ID: result.data[key].PakgType },
                                'GrsWt': result.data[key].GrsWt,
                                'NtWt': result.data[key].NtWt,
                                'VGM': result.data[key].VGM,
                                'CBM': result.data[key].CBM,
                            });

                        });
                    }
                    else {


                    }
                    $("#overlay").hide();
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }
        $scope.getPaging = function (tab) {

            //if (typeof $scope.RegId == "undefined" || typeof $scope.RegId == "") {
            //    ShowPopup("please fill RATE REQUEST first1");
            //    return;
            //}

            var myp = $scope.RegId;
            var BkgID = $scope.HDBkgID;
            if (tab == 1) {
                if (myp != "0") {
                    var url = "/Import/ShipmentDetails?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
            else if (tab == 2) {
                if (myp != "0") {
                    var url = "/Import/ContainerDetails?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
            else if (tab == 3) {
                if (myp != "0") {
                    var url = "/Import/ImpTariffview?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
            else if (tab == 4) {
                if (myp != "0") {
                    var url = "/Import/CAN?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
            else if (tab == 5) {
                if (myp != "0") {
                    var url = "/Import/DeliveryOrder?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
           
            else if (tab == 7) {
                if (myp != "0") {
                    var url = "/Import/DetDem?ImpReg=" + encodeURIComponent(myp) + "&BkgID=" + encodeURIComponent(BkgID);
                    window.location.href = url;
                }
                else {
                    ShowPopup("Please Create Shipment Details")
                    return false;
                }
            }
            return false;
        }

        $scope.HouseBLOnclick = function () {

            if ($('#ddlBLType').val() == "40") {
                $scope.ddlBLType = { ID: 43 };
                $scope.HDParentBLID = $scope.RegId;
                $scope.RegId = 0;
                $scope.txtBookingNo = "";
                $scope.IsVisibleCntr = true;
                $scope.IsBLNodisablevalue = false;
                $scope.btnContainerAssign = false;
                $scope.IsdisablevaluePort = false;
                ShowPopup("PartBL setup after save Record");
            }
            else {
                ShowPopup("Only Mother BL should be PartBL");
            }
        }

        $scope.RemoveContainer = function (DynamicGridContainer, index) {
           
            $scope.DynamicGridContainer.splice(index, 1);

        }


        $scope.CntrNoPickup = function () {

           
            var validation = "";
            if (typeof $scope.HDBkgID == "undefined") {
                validation += "<span style='color:red;'>*</span> <span>Please Generate the BL first </span></br>"
            }

            if ($scope.BLVesVoyID == "" || $scope.BLVesVoyID == "undefined" || $scope.BLVesVoyID == "0") {

                validation += "<span style='color:red;'>*</span> <span>Please select Vessel & Voyage </span></br>"
            }

            if (validation != "") {
                ShowPopup(validation);
                return false;
            }
            $('#overlay').show();
            $('#Pickup').modal('show');
            var BussData = {};
            BussData.POL = $('#ddlPOL').val();
            BussData.CntrNo = $('#txtConainer').val();
            $http({
                method: 'POST',
                url: '/api/ImportApi/ImpBookingCntrPickup/',
                data: JSON.stringify(BussData),
            }).then(function (result) {
                $timeout(function () {

                    $scope.fillCntrNoPickup = result.data;
                    $("#overlay").hide();

                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {
                ShowPopup('There has been an error: ' + result);
            });

        }


       


        $scope.UpdateFV = function (gDate) {
            var validation = "";

           

            var PickupDate = $('#txtPickupDate').val();
            if (PickupDate.length == "") {
                validation += "<span style='color:red;'>*</span> <span>Please select PickupDate </span></br>"
            }
            if ($scope.BLVesVoyID == "" || $scope.BLVesVoyID == "?") {

                validation += "<span style='color:red;'>*</span> <span>Please select VoyageNo </span></br>"
            }

            if (validation != "") {
                ShowPopup(validation);
                return false;
            }

            var BussData = {};
            var Items = [];
            BussData.BkgID = $scope.HDBkgID;
            BussData.VesVoyID = $scope.BLVesVoyID;
            BussData.PickupDate = $('#txtPickupDate').val();

            angular.forEach(gDate, function (value, key) {
                if (gDate[key].IsTrue == 1) {
                    Items.push(gDate[key].ID);
                }
            });
            BussData.CntrID = Items.toString();

            $http({
                method: 'POST',
                url: '/api/ImportApi/ImportCheckDtMovmentLast/',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $timeout(function () {

                    var DtMovement = result.data[0].DtMovement;
                    var Local1 = moment.utc(DtMovement).local().format('MMM DD YYYY h:mm A');
                    var local = moment.utc($('#txtPickupDate').val()).local().format('MMM DD YYYY h:mm A');

                    if (Date.parse(Local1) >= Date.parse(local)) {
                        ShowPopup("<span style='color:red;'>*</span> <span>Date of Movement should be greater than previous movement Date</span></br>");
                        return;
                    }

                    $scope.CntrLastMovemntInsertFV(gDate);


                });
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });

        }

        $scope.CntrLastMovemntInsertFV = function (gDate) {

            var validation = "";
            var ddlVesVoy = $('#ddlVesVoy').val();
            if (ddlVesVoy == "?") {
                validation += "<span style='color:red;'>*</span> <span>Please select Vessel Voyage </span></br>"
            }


            if (validation != "") {
                ShowPopup(validation);
                return false;
            }


            var BussData = {};
            var Items = [];
            BussData.ID = $scope.RegId;
            BussData.BkgID = $scope.HDBkgID;
            BussData.VoyID = $("#ddlVesVoy").val();
            BussData.PickupDate = $('#txtPickupDate').val();
            BussData.LocationID = $('#ddlPOD').val();
            BussData.AgentName = "";
            BussData.AgentID = localStorage.getItem("AgencyID");
            BussData.CustomerID = $("#ddlShipper").val();
            BussData.UserID = localStorage.getItem("UserID");
            BussData.VoyageID = $("#ddlVesVoy").val();
            BussData.StatusCode = "FV";

            BussData.VesVoy = $("#ddlVesVoy option:selected").text();

            angular.forEach(gDate, function (value, key) {
                if (gDate[key].IsTrue == 1)
                {
                    Items.push('Insert:' + gDate[key].ID, gDate[key].LocationID, gDate[key].CurrentDepotID);

                }
            });
            BussData.Items = Items.toString();

            $http({
                method: 'POST',
                url: '/api/ImportApi/ImpInsertCntrLastMovmentMaster/',
                data: JSON.stringify(BussData),

            }).then(function (result) {
                $timeout(function () {

                    ShowPopup("Container Discharge FV Status Successfully");
                    $('#Portin').modal('hide');
                    $scope.ImportCntrPickupDetails($scope.HDBkgID);
                   
                });
              
            }, function (result) {
                if (result.status == 500) {
                    ShowPopup("Sorry no internet connectivity Application Error.");
                }
                else if (result.status == 404) {
                    ShowPopup("Sorry no internet connectivity page not found.");
                }
                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            }).catch(function (result) {

                ShowPopup('There has been an error: ' + result);
            });
        }


        $scope.ImportCntrPickupDetails = function (HDBkgID) {
            $("#overlay").show();
            var Datavalue = {};
            Datavalue.BkgID = HDBkgID;
            $http({
                method: 'POST',
                url: '/api/ImportApi/ImportCntrPickupRecord',
                data: JSON.stringify(Datavalue),

            }).then(function (result) {

                $timeout(function () {
                    if (result.data.length > 0) {
                        if (result.data[0].CntrType != "") {
                            $scope.DynamicGridContainer.splice(0, 1);
                        }

                        angular.forEach(result.data, function (value, key) {
                            $scope.DynamicGridContainer.push({
                                'BCNID': result.data[key].BCNID,
                                'ContainerNo': { ID: result.data[key].CntrID },
                                'Size': result.data[key].Size,
                                'ISOCode': result.data[key].ISOCode,
                                'SealNo': "",
                                'NoOfPkg': "",
                                'PakgType': "",
                                'GrsWt': "",
                                'NtWt': "",
                                'VGM': "",
                                'CBM': ""

                            });

                        });
                    }
                    else {


                    }
                    $("#overlay").hide();
                });
            }, function (result) {

                if (result.status > 0) {
                    var errorMsg = result.status + ': ' + result.data;
                    ShowPopup("Sorry no internet connectivity detected.Please reconnect and try  again.");
                }
            });
        }


        $scope.ModeFunction = function (gRow, Index) {
            if (gRow.Mode.ID == 1) {

                $scope.DynamicGridMode.length = 0;
                $scope.DynamicGridMode.push({
                    'Mode': { ID: 1 },
                    'ImpFreeDays': ""
                });
            }

            if (Index == 1) {
            } else {
                if (gRow.Mode.ID != 1)
                {
                    if ($scope.DynamicGridMode.length != 3)
                    {
                        $scope.DynamicGridMode.push({
                            'Mode': "",
                            'ImpFreeDays': ""
                        });
                    }
                }
            }
        }

    });
    function ShowPopup(message) {
        swal(message);
    };
</script>
<style>
    .downbtn .btn {
        padding: 6px 12px;
    }
</style>
<link href="~/assets/css/common.css" rel="stylesheet" />
<div ng-app="MyApp" ng-controller="MyController">

    <div id="overlay" style="display:none;">
        <div class="loadcontainer">
            <div class="spinner"></div>
            <p>Loading Please Wait</p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 backbtn" style="text-align:right;">
            <a href="/Import/ImportView" type="submit" class="btn btn-fill btnback btn-success btn-round btntop">
                <i class="material-icons">reply</i> Back
            </a>
            @*<a href="#" type="submit" class="btn btn-fill btnedit btn-warning btn-round btntop">
                <i class="material-icons">edit</i>
            </a>*@
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header card-header-primary card-header-icon">
                    <div class="card-icon">
                        Shipment Details
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-6">
                        <label ng-show="DisplayBindMBLNo"><span style="color:red;">MBL Number: </span><span style="color:red;" ng-bind="BindMBLNo"></span> </label>
                    </div>

                    <div class="col-md-2" style="text-align:right;">
                        <label style=" margin-top: 11px;">
                            <span style="color: red;">MODE: </span><span style="color:red;" ng-bind="IsOnLinedisplay"></span>

                        </label>
                    </div>
                    <div class="col-md-2 pull-right">

                        <div class="dropdown">
                            <a class="btn btn-success btndrop dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                BL OPTIONS
                            </a>

                            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                <a class="dropdown-item" href="#" id="btnHoueBL" ng-click="HouseBLOnclick();"><i class="fa fa-bookmark" style="color: #0585b5;"></i> <span style="padding-left:20px;">HOUSE BL</span></a>
                                <a class="dropdown-item" href="#" id="btnExemtion" ng-click="ExemptionOnclick();"><i class="fa fa-asterisk"></i> <span style="padding-left:20px;">BL EXEMPTION</span></a>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                                <a class="nav-item nav-link active" ng-click="getPaging(1);" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Shipment Details</a>
                                <a class="nav-item nav-link" ng-click="getPaging(2);" id="nav-Key-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Container Details</a>
                                <a class="nav-item nav-link" id="nav-contact-tab" ng-click="getPaging(4);" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">CAN</a>
                                <a class="nav-item nav-link" id="nav-contact-CAN" ng-click="getPaging(5);" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">Delivery Order/Empty Returns</a>
                                <a class="nav-item nav-link" id="nav-profile-tab" ng-click="getPaging(3);" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Destination Chargges</a>
                                <a class="nav-item nav-link" ng-click="getPaging(7);" data-toggle="tab" href="#nav-about" role="tab" aria-controls="nav-about" aria-selected="false">DET/DEM Calculation</a>
                            </div>
                        </nav>
                    </div>
                </div>



                <div class="card-body">



                    <div class="row" style="border-bottom:2px dashed #ccc;margin-bottom:14px;">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12" style="margin-top:2px;">
                                                <label>Booking/BL</label>
                                                <input type="text" autocomplete="off" ng-disabled="IsBLNodisablevalue" id="txtBookingNo" ng-model="txtBookingNo" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>BL Type</label>
                                                <select class="form-control" id="ddlBLType" style="color:red;" disabled ng-model="ddlBLType" options="{ allowClear: true }" ng-options="item.GeneralName for item in BlTypesAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Booking Party</label>
                                                <select id="ddlBookingParty" ng-disabled="Isdisablevalue" class="form-control my-select" ng-model="ddlBookingParty" ng-options="item.CustomerName for item in BookingPartyAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Rate Request No</label>
                                                <input ng-model="txtRRNO" id="txtRRNo" autocomplete="off" disabled class="form-control" />

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>POO</label>
                                                <select id="ddlPOO" class="form-control my-select" ng-disabled="IsdisablevaluePort" ng-model="ddlPOO" ng-options="item.CityName for item in CityMasterAllvalues track by item.ID"></select>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>POL</label>
                                                <select id="ddlPOL" ng-model="ddlPOL" class="form-control my-select" ng-disabled="Isdisablevalue" placeholder="POL" ng-options="item.PortName for item in PortAllvalues track by item.ID">
                                                </select>


                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>POD</label>
                                                <select id="ddlPOD" class="form-control my-select" ng-model="ddlPOD" ng-disabled="Isdisablevalue" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>FPOD</label>
                                                <select id="ddlFPOD" class="form-control my-select" ng-model="ddlFPOD" ng-disabled="IsdisablevaluePort" options="{ allowClear: true }" ng-options="item.CityName for item in CityMasterAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>



                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Shipper</label>
                                                <select id="ddlShipper" ng-model="ddlShipper" class="form-control my-select" ng-disabled="Isdisablevalue" options="{ allowClear: true }" ng-options="item.CustomerName for item in BookingPartyAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Consignee</label>
                                                <select id="ddlConsignee" ng-model="ddlConsignee" class="form-control my-select" ng-disabled="Isdisablevalue" options="{ allowClear: true }" ng-options="item.CustomerName for item in BookingPartyAllvalues track by item.ID">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Nofify</label>
                                                <select id="ddlNotify" ng-model="ddlNotify" class="form-control my-select" ng-disabled="Isdisablevalue" options="{ allowClear: true }" ng-options="item.CustomerName for item in BookingPartyAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Delivery Agent</label>
                                                <select class="form-control my-select" id="ddlDestinationAgent" ng-disabled="Isdisablevalue" ng-model="ddlDestinationAgent" ng-options="item.AgencyName for item in AgencyMasterAllvalues track by item.ID">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Commodity</label>
                                                <select id="ddlCommodityType" ng-model="ddlCommodityType" ng-disabled="Isdisablevalue" class="form-control" ng-options="item.GeneralName for item in CommodityValue track by item.ID">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                @*<div class="col-md-3">
            <div class="form-group">
                <div class="row">
                    <div class="col-md-12">
                        <label>HBL Number</label>
                        <input id="txtHBLNo" ng-model="txtHBLNo" class="form-control" />
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <div class="row">
                    <div class="col-md-12">
                        <label>HBL Date</label>
                        <input id="txtHBLDate" type="date" ng-model="txtHBLDate" class="form-control" />
                    </div>
                </div>
            </div>
        </div>*@
                                @*<div class="col-md-3">
            <div class="form-group">
                <div class="row">
                    <div class="col-md-12" style="margin-top:2px;">
                        <label>Free Days @@ POD</label>
                        <input id="txtFreeDays" ng-model="txtFreeDays" ng-disabled="FreeDaydisable" class="form-control" />
                    </div>
                </div>
            </div>
        </div>*@

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Surrender Status</label>
                                                <select class="form-control my-select" ng-disabled="Isdisablevalue" id="ddlSurrender" ng-model="ddlSurrender" ng-options="item.GeneralName for item in SurrenderAllvalues track by item.ID"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Delivery Type</label>
                                                <select id="ddlDeliveryType" ng-model="ddlDeliveryType" class="form-control my-select" ng-options="item.GeneralName for item in ModuleAllvalues track by item.ID">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>CFS</label>
                                                <select id="ddlCustomerCFS" ng-model="ddlCustomerCFS" class="form-control my-select" ng-options="item.CustomerName for item in CustomerCFSMaster track by item.ID"> </select>
                                                @*<input id="txtCFS" ng-model="txtCFS" class="form-control" />*@
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Nomination CFS Type</label>

                                                <select id="ddlNomCFSType" ng-model="ddlNomCFSType" class="form-control my-select" ng-options="item.GeneralName for item in NominationCFSTypes track by item.ID"> </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Import IHC</label>

                                                <select id="ddlImpIHC" ng-model="ddlImpIHC" class="form-control my-select" ng-options="item.name for item in ImpIHCValues track by item.ID"> </select>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>Principal Name</label>

                                                <select id="ddlPrincipal" ng-disabled="ddlPrincipaldisplay" ng-model="ddlPrincipal" class="form-control my-select" ng-options="item.CustomerName for item in PrincipalAllvalues track by item.ID"> </select>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">

                                </div>

                                <div class="col-md-8">
                                    <h5 style="font-size:12px; margin-bottom:5px;font-weight: bold;color: #e91e63;">Import Freedays</h5>
                                    <div class="material-datatables">

                                        <table class="table table-striped table-no-bordered table-hover" cellspacing="0" style="width:50%">

                                            <thead>
                                                <tr>
                                                    <th>Mode</th>
                                                    <th>Import Freedays</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="gRow in DynamicGridMode">

                                                    <td>
                                                        <select class="form-control" id="ddlMode" ng-change="ModeFunction(gRow,$index)" ng-model="gRow.Mode" ng-options="item.name for item in BindModeValues track by item.ID"></select>
                                                    </td>

                                                    <td><input type="text" autocomplete="off" onkeypress="return numericvalidation();" class="form-control" ng-model="gRow.ImpFreeDays" /></td>

                                                </tr>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>

                                @*<div class="col-md-4">

            <div class="form-group">
                <div class="row">
                    <div class="col-md-12">
                        <label>Marks & Description</label>

                        <textarea id="txtImpMarks" ng-model="txtImpMarks"  class="form-control" style="height:100px!important;"></textarea>

                    </div>
                </div>
            </div>


        </div>*@
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Marks & Number</label>
                                                        <textarea id="txtImpMarks" ng-model="txtImpMarks" style="height:100px!important;" ng-disabled="ControlMaindisable" class="form-control" rows="6"></textarea>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <label>Cargo Description</label>
                                                        <textarea id="txtCargoDesc" ng-model="txtCargoDesc" style="height:100px!important;" ng-disabled="ControlMaindisable" class="form-control" rows="6"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-md-3">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <label>.</label>
                                                <button ng-show="btnContainerAssign" ng-click="CntrNoPickup();" type="submit" class="btn btn-fill btn-danger">
                                                    <i class="material-icons"></i>
                                                    Container Number Assigning
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                            </div>
                            </div>
                    </div>

                    <div class="col-md-12 padlr0">
                        <div class="material-datatables">
                            <table class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>S.No</th>
                                        <th>Container No <span style="color:white; font-size:20px;">*</span><span style="color:red; font-size:10px; position:absolute;">*</span></th>
                                        <th>Size <span style="color:white; font-size:20px;">*</span></th>
                                        <th>ISO Code <span style="color:white; font-size:20px;">*</span></th>
                                        <th>Seal Number <span style="color:white; font-size:20px;">*</span></th>
                                        <th>No.Of.Package <span style="color:white; font-size:20px;">*</span></th>
                                        <th>Pkg Type <span style="color:white; font-size:20px;">*</span></th>
                                        <th>Gross.Wt <span style="color:white; font-size:20px;">*</span></th>
                                        <th>Net.Wt</th>
                                        <th>VGM</th>
                                        <th>CBM</th>

                                        <th class="disabled-sorting text-right">Action</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    <tr ng-repeat="gR in DynamicGridContainer">
                                        <td>{{$index+1}}</td>
                                        <td>
                                            <input type="checkbox" id="cntrCheck" ng-show="IsVisible" />
                                        </td>
                                        <td><select style="width:100px;" class="form-control" disabled ng-change="SelectContainer(gR)" id="ddlContainerNo" ng-model="gR.ContainerNo" options="{ allowClear: true }" ng-options="item.CntrNo for item in CntrNoValues track by item.ID"></select></td>
                                        <td><input id="txtSize" ng-model="gR.Size" disabled class="form-control" /></td>
                                        <td><input id="txtISOCode" ng-model="gR.ISOCode" disabled class="form-control" /></td>
                                        <td><input id="txtSealNo" autocomplete="off" ng-disabled="IsdisablevalueHid" ng-model="gR.SealNo" class="form-control" /></td>
                                        <td><input id="txtNoOfPkg" ng-model="gR.NoOfPkg" ng-disabled="IsdisablevalueHid" autocomplete="off" onkeypress="return numericvalidation();" class="form-control" /></td>
                                        <td><select style="width:60px;" class="form-control" ng-disabled="IsdisablevalueHid" id="ddlPakgType" ng-model="gR.PakgType" options="{ allowClear: true }" ng-options="item.CargoName for item in CargoMasterAllvalues track by item.ID"></select></td>
                                        <td><input id="txtGrsWt" onkeypress="return numericvalidation();" ng-disabled="IsdisablevalueHid" autocomplete="off" ng-model="gR.GrsWt" class="form-control" /></td>
                                        <td><input id="txtNtWt" onkeypress="return numericvalidation();" ng-disabled="IsdisablevalueHid" autocomplete="off" ng-model="gR.NtWt" class="form-control" /></td>
                                        <td><input id="txtVGM" onkeypress="return numericvalidation();" ng-disabled="IsdisablevalueHid" autocomplete="off" ng-model="gR.VGM" class="form-control" /></td>
                                        <td><input id="txtCBM" onkeypress="return numericvalidation();" ng-disabled="IsdisablevalueHid" autocomplete="off" ng-model="gR.CBM" class="form-control" /></td>
                                        <td style="display:none;"><input type="hidden" id="HDBCNID" ng-disabled="IsdisablevalueHid" class="form-control" ng-model="gRow.BCNID" /></td>
                                        <td class="td-actions text-right">
                                            <button type="button" id="BtnAddCntr" rel="tooltip" ng-show="IsVisibleCntr" ng-if="$last" ng-click="ContainerRowAdd(DynamicGridContainer,$index)" class="btn btn-primary btn-round" data-original-title="" title="">
                                                <i class="material-icons">add</i>
                                            </button>
                                            <button type="button" rel="tooltip" ng-if="!$last" ng-show="IsVisibleCntr" ng-click="RemoveContainer(DynamicGridContainer,$index)" class="btn btn-danger btn-round" data-original-title="" title="">
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>
                    </div>

                    <div class="row" style="border-top:2px dashed #ccc;padding-top:14px;">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-12">
                                    <h5 style="font-size:12px; margin-bottom:5px;font-weight: bold;color: #e91e63;">Vessel & Voyage Details</h5>
                                    <div class="material-datatables">
                                        <table class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%; margin-bottom:0px;">
                                            <thead>
                                                <tr>

                                                    <th>Leg No</th>
                                                    <th>Voyage Type</th>
                                                    <th>Vessel & Voyage</th>
                                                    <th>Load Port</th>
                                                    <th>Next Port</th>
                                                    <th>ETA</th>
                                                    <th>ETD</th>
                                                    <th>#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="gRow in DynamicGridVesselVoyage | filter : paginate | orderBy:'-Statusv'">

                                                    <td><select class="form-control"  id="ddlVoyageTypes" ng-model="gRow.VoyageTypes" options="{ allowClear: true }" ng-options="item.GeneralName for item in voyageTypes track by item.ID"></select></td>
                                                    <td><select class="form-control"  id="ddlLeginformation" ng-model="gRow.LegInformation" options="{ allowClear: true }" ng-options="item.GeneralName for item in LegInformation track by item.ID"></select></td>
                                                    <td><select id="ddlVesVoy"  ng-model="gRow.VesVoy" ng-change="SelectVesselVoyage(gRow)" class="form-control" ng-options="item.VesVoy for item in VesselNameAllvalues track by item.ID"></select></td>
                                                    <td><select id="ddlLoadPort" ng-disabled="Isdisablevalue" class="form-control" ng-model="gRow.LoadPort" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select></td>
                                                    <td><select id="ddlNextPort" ng-disabled="Isdisablevalue" class="form-control" ng-model="gRow.NextPort" options="{ allowClear: true }" ng-options="item.PortName for item in PortAllvalues track by item.ID"></select></td>
                                                    <td>
                                                        <input id="txtETA" type="text" ng-disabled="Isdisablevalue" class="form-control" ng-model="gRow.ETA" />
                                                    </td>
                                                    <td>
                                                        <input id="txtETD" type="text" ng-disabled="Isdisablevalue" class="form-control" ng-model="gRow.ETD" />


                                                    </td>

                                                    <td class="td-actions text-right">
                                                        <button type="button" rel="tooltip" ng-if="$last" ng-show="IsVisible" ng-click="VoyageRowAdd(DynamicGridVesselVoyage,$index)" class="btn btn-primary btn-round" data-original-title="" title="">
                                                            <i class="material-icons">add</i>
                                                        </button>
                                                        <button type="button" rel="tooltip" ng-if="!$last" ng-show="IsVisible" ng-click="RemoveVoyage(DynamicGridVesselVoyage,$index)" class="btn btn-danger btn-round" data-original-title="" title="">
                                                            <i class="material-icons">delete</i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>

                    <!-- Modal body -->
                    <div class="row">
                        <div class="col-md-12">

                            <div class="modal" id="Pickup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content" style="margin:0 auto; width:860px;">

                                        <!-- Modal Header -->
                                        <div class="modal-header">
                                            <h4 class="modal-title">Select Container</h4>
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>

                                        <!-- Modal body -->
                                        <div class="modal-body" style="padding-bottom:0;border-bottom: 1px solid #ccc;margin-bottom:6px;">
                                            <div class="row">
                                                <div class="col-md-3"><h5 style="margin-top:10px;">Container</h5></div>
                                                <div class="col-md-9">
                                                    <div class="form-group">
                                                        <div class="row">
                                                            <div class="col-md-8">
                                                                <input type="text" id="txtConainer" style="width:100%;" class="form-control" ng-model="txtConainer" />
                                                            </div>
                                                            <div class="col-md-1">
                                                                @*<a href="#" ng-click="CntrNoPickupSearch();"> <i class="material-icons">search</i></a>*@
                                                                <a href="#" ng-click="CntrNoPickup();"> <i class="material-icons">search</i></a>
                                                               
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row pickupdiv">
                                                <div class="col-md-12">
                                                    <div class="material-datatables" style="overflow:auto;height:200px;">
                                                        <table class="table table-striped table-no-bordered table-hover" style="margin-bottom:-2px;">

                                                            <thead>
                                                                <tr>
                                                                    <th>#</th>
                                                                    <th>Container #</th>
                                                                    <th>Size Type</th>
                                                                    <th>Location</th>
                                                                    <th>Agent</th>
                                                                    <th>Current Depot</th>
                                                                    <th>Status</th>

                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="gRow in fillCntrNoPickup">
                                                                    <td>
                                                                        <input type="checkbox" ng-true-value="1" ng-click="CntrNoCountValidation(fillCntrNoPickup);" ng-checked="gRow.IsTrue" ng-false-value="0" id="InvCheck" ng-model="gRow.IsTrue" />
                                                                    </td>
                                                                    <td>{{gRow.CntrNo}}</td>
                                                                    <td>{{gRow.Size}}</td>
                                                                    <td>{{gRow.Location}}</td>
                                                                    <td>
                                                                        {{gRow.AgentName}}
                                                                    </td>
                                                                    <td>{{gRow.CntrDepo}}</td>
                                                                    <td>{{gRow.StatusCode}}</td>

                                                                </tr>
                                                            </tbody>
                                                        </table>


                                                    </div>
                                                    @*<div class="material-datatables" style="overflow-y:scroll; height:250px;">


                                            </div>*@
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <label>DISCHARGE DATE(FV)</label>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <input type="datetime-local" id="txtPickupDate" ng-model="txtPickupDate" class="form-control" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <label>BLNO</label>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <span ng-bind="ContainerAssignBLNO"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-top:30px;">
                                                <div class="col-md-12" style="text-align:right;">
                                                    <a href="#" class="btn btn-success" style="padding: 7px 25px;margin-top:-2px;" ng-click="UpdateFV(fillCntrNoPickup);"><i class="fa fa-plus"></i> Pickup</a>
                                                    <a href="#" class="btn btn-danger" style="padding: 7px 25px;margin-top:-2px;"><i class="fa fa-trash"></i> Cancel</a>
                                                </div>
                                            </div>
                                        </div>


                                    </div>



                                </div>
                            </div>

                        </div>

                    </div>


                    <div class="row">
                        <div class="col-md-12" style="text-align:right; margin-top:15px;">
                            <button type="submit" ng-click="RecordSave(DynamicGridVesselVoyage,DynamicGridContainer,DynamicGridMode);" class="btn btn-fill btn-success">
                                <i class="material-icons">save</i>
                                Save
                            </button>
                            <input type="hidden" id="RegId" ng-model="RegId" />
                            <input type="hidden" id="HDParentBLID" ng-model="HDParentBLID" />
                            <input type="hidden" id="HdID" ng-model="HdID" />
                            <input type="hidden" id="HDDirectImport" ng-model="HDDirectImport" />
                            <input type="hidden" id="HDBkgID" ng-model="HDBkgID" />

                            <input type="hidden" id="BLVesVoy" ng-model="BLVesVoy" />
                            <input type="hidden" id="BLVesVoyID" ng-model="BLVesVoyID" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

